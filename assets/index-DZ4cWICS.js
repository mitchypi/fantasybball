(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();const nt="./";async function ln(){const e=await fetch(`${nt}data/manifest.json`);if(!e.ok)throw new Error(`Manifest HTTP ${e.status}`);return e.json()}async function dn(e){const n=await fetch(`${nt}data/scoreboard/${e}.json`);if(n.status===404)return{date:e,games:[]};if(!n.ok)throw new Error(`Scoreboard HTTP ${n.status}`);return n.json()}async function un(e){const n=await fetch(`${nt}data/boxscores/${e}.json`);if(!n.ok)throw new Error(`Boxscore HTTP ${n.status}`);return n.json()}const Qe=(e,n)=>n.some(a=>e instanceof a);let kt,wt;function fn(){return kt||(kt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mn(){return wt||(wt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Xe=new WeakMap,Ge=new WeakMap,He=new WeakMap;function pn(e){const n=new Promise((a,c)=>{const o=()=>{e.removeEventListener("success",i),e.removeEventListener("error",d)},i=()=>{a(pe(e.result)),o()},d=()=>{c(e.error),o()};e.addEventListener("success",i),e.addEventListener("error",d)});return He.set(n,e),n}function bn(e){if(Xe.has(e))return;const n=new Promise((a,c)=>{const o=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",d),e.removeEventListener("abort",d)},i=()=>{a(),o()},d=()=>{c(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",i),e.addEventListener("error",d),e.addEventListener("abort",d)});Xe.set(e,n)}let Ze={get(e,n,a){if(e instanceof IDBTransaction){if(n==="done")return Xe.get(e);if(n==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return pe(e[n])},set(e,n,a){return e[n]=a,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function Tt(e){Ze=e(Ze)}function hn(e){return mn().includes(e)?function(...n){return e.apply(et(this),n),pe(this.request)}:function(...n){return pe(e.apply(et(this),n))}}function gn(e){return typeof e=="function"?hn(e):(e instanceof IDBTransaction&&bn(e),Qe(e,fn())?new Proxy(e,Ze):e)}function pe(e){if(e instanceof IDBRequest)return pn(e);if(Ge.has(e))return Ge.get(e);const n=gn(e);return n!==e&&(Ge.set(e,n),He.set(n,e)),n}const et=e=>He.get(e);function yn(e,n,{blocked:a,upgrade:c,blocking:o,terminated:i}={}){const d=indexedDB.open(e,n),h=pe(d);return c&&d.addEventListener("upgradeneeded",m=>{c(pe(d.result),m.oldVersion,m.newVersion,pe(d.transaction),m)}),a&&d.addEventListener("blocked",m=>a(m.oldVersion,m.newVersion,m)),h.then(m=>{i&&m.addEventListener("close",()=>i()),o&&m.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),h}const vn=["get","getKey","getAll","getAllKeys","count"],kn=["put","add","delete","clear"],Ye=new Map;function Et(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(Ye.get(n))return Ye.get(n);const a=n.replace(/FromIndex$/,""),c=n!==a,o=kn.includes(a);if(!(a in(c?IDBIndex:IDBObjectStore).prototype)||!(o||vn.includes(a)))return;const i=async function(d,...h){const m=this.transaction(d,o?"readwrite":"readonly");let g=m.store;return c&&(g=g.index(h.shift())),(await Promise.all([g[a](...h),o&&m.done]))[0]};return Ye.set(n,i),i}Tt(e=>({...e,get:(n,a,c)=>Et(n,a)||e.get(n,a,c),has:(n,a)=>!!Et(n,a)||e.has(n,a)}));const wn=["continue","continuePrimaryKey","advance"],St={},tt=new WeakMap,It=new WeakMap,En={get(e,n){if(!wn.includes(n))return e[n];let a=St[n];return a||(a=St[n]=function(...c){tt.set(this,It.get(this)[n](...c))}),a}};async function*Sn(...e){let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...e)),!n)return;n=n;const a=new Proxy(n,En);for(It.set(a,n),He.set(a,et(n));n;)yield a,n=await(tt.get(a)||n.continue()),tt.delete(a)}function $t(e,n){return n===Symbol.asyncIterator&&Qe(e,[IDBIndex,IDBObjectStore,IDBCursor])||n==="iterate"&&Qe(e,[IDBIndex,IDBObjectStore])}Tt(e=>({...e,get(n,a,c){return $t(n,a)?Sn:e.get(n,a,c)},has(n,a){return $t(n,a)||e.has(n,a)}}));const $n="fantasybball",Bn=3;let ze=null;function N(){return ze||(ze=yn($n,Bn,{upgrade(e){e.objectStoreNames.contains("system")||e.createObjectStore("system",{keyPath:"key"}).put({key:"system",currentDate:new Date().toISOString().slice(0,10),bankroll:1e3,initialBankroll:1e3,pendingStake:0,pendingPotential:0}),e.objectStoreNames.contains("bets")||e.createObjectStore("bets",{keyPath:"id",autoIncrement:!0}),e.objectStoreNames.contains("scoreboards")||e.createObjectStore("scoreboards"),e.objectStoreNames.contains("boxscores")||e.createObjectStore("boxscores"),e.objectStoreNames.contains("simulations")||e.createObjectStore("simulations")}})),ze}async function Cn(){return await(await N()).get("system","system")}async function Le(e){const n=await N(),c={...await n.get("system","system"),...e};return await n.put("system",c),c}async function Ln(e){const a=await(await N()).add("bets",e);return{...e,id:a}}async function Bt(){return await(await N()).transaction("bets").objectStore("bets").getAll()}async function xn(e,n){const a=await N(),c=await a.get("bets",e);c&&await a.put("bets",{...c,...n})}async function _n(e,n){await(await N()).put("scoreboards",n,e)}async function Dn(e){return(await N()).get("scoreboards",e)}async function Nn(e,n){await(await N()).put("boxscores",n,String(e))}async function Tn(e){return(await N()).get("boxscores",String(e))}async function Ct(e){return(await N()).get("simulations",e)}async function Lt(e,n){return await(await N()).put("simulations",n,e),n}async function In(){await(await N()).clear("bets")}async function jn(){await(await N()).clear("simulations")}async function Mn(){await(await N()).clear("scoreboards")}async function Pn(){await(await N()).clear("boxscores")}function w(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function be(e){return Number.isFinite(e)?e>0?1+e/100:1+100/Math.abs(e):1}function Hn(e){return!Number.isFinite(e)||e<=1?0:e>=2?Math.round((e-1)*100):Math.round(-100/(e-1))}function O(e,n="USD"){const a=Number(e)||0;return new Intl.NumberFormat(void 0,{style:"currency",currency:n}).format(a)}function Rn(e,n,a={}){e.innerHTML="",e.classList.add("scoreboard-list");const c=n.games||[];if(!c.length){const o=document.createElement("li");o.className="score-card disabled",o.innerHTML='<div class="teams"><div class="team-row"><span>No games to show.</span></div></div>',e.appendChild(o);return}c.forEach(o=>{const i=document.createElement("li");i.className="score-card",i.dataset.gameId=String(o.game_id),i.dataset.date=n.date||"";const d=document.createElement("div");d.className="score-summary";const m=(a.showFinalScores??!0)&&o.simulated,g=m?o.away_score??"--":"--",v=m?o.home_score??"--":"--",$=m?o.status||"Final":"Awaiting simulation",S=m?"status-final":"status-upcoming";d.innerHTML=`
      <div class="teams">
        <div class="team-row"><span>${w(o.away_team||"")}</span><span>${w(String(g))}</span></div>
        <div class="team-row"><span>${w(o.home_team||"")}</span><span>${w(String(v))}</span></div>
      </div>
      <div class="meta">
        <div class="${S}">${w($)}</div>
        ${o.time?`<div>${w(o.time)}</div>`:""}
        ${o.period_display?`<div>${w(o.period_display)}</div>`:""}
      </div>
    `,i.appendChild(d);const J=An(o,a.oddsFormat??"american",a.onOddsSelected);if(J&&i.appendChild(J),a.onRequestBoxscore&&m){const D=document.createElement("div");D.className="score-detail",D.innerHTML='<p class="muted">Click to load the full box score.</p>',i.appendChild(D),d.addEventListener("click",()=>ce()),d.addEventListener("keydown",Q=>{(Q.key==="Enter"||Q.key===" ")&&(Q.preventDefault(),ce())}),d.setAttribute("role","button"),d.setAttribute("tabindex","0");async function ce(){var U;if(i.classList.contains("active")){i.classList.remove("active"),D.innerHTML='<p class="muted">Click to load the full box score.</p>';return}i.classList.add("active"),D.innerHTML='<p class="muted">Loading box score…</p>';try{const F=await((U=a.onRequestBoxscore)==null?void 0:U.call(a,o.game_id,n.date));if(!F){D.innerHTML='<p class="muted">Box score unavailable.</p>';return}Vn(D,F)}catch(F){D.innerHTML=`<p class="error">${w(F.message||"Unable to load box score.")}</p>`}}}e.appendChild(i)})}function An(e,n,a){const c=e==null?void 0:e.odds;if(!c||!c.markets)return null;const o=document.createElement("div");o.className="odds-preview";const i=c.markets;return i.moneyline&&o.appendChild(Je("Moneyline",On(e,i.moneyline,c,n,a))),i.spread&&o.appendChild(Je("Spread",Fn(e,i.spread,c,n,a))),i.total&&o.appendChild(Je("Total",qn(e,i.total,n,a))),o.childNodes.length?o:null}function Je(e,n){if(!n.length)return document.createElement("div");const a=document.createElement("div");a.className="odds-market";const c=document.createElement("div");c.className="odds-market__title",c.textContent=e;const o=document.createElement("div");return o.className="odds-market__chips",n.forEach(i=>o.appendChild(i)),a.append(c,o),a}function On(e,n,a,c,o){var v,$;const i=[],d=((v=a==null?void 0:a.home_team)==null?void 0:v.full_name)||e.home_team,h=(($=a==null?void 0:a.away_team)==null?void 0:$.full_name)||e.away_team,m=d?n==null?void 0:n[d]:void 0,g=h?n==null?void 0:n[h]:void 0;return g&&i.push(_e(e,"moneyline","away",g.price,`${h||e.away_team} ML`,void 0,c,o)),m&&i.push(_e(e,"moneyline","home",m.price,`${d||e.home_team} ML`,void 0,c,o)),i}function Fn(e,n,a,c,o){var v,$;const i=[],d=((v=a==null?void 0:a.home_team)==null?void 0:v.full_name)||e.home_team,h=(($=a==null?void 0:a.away_team)==null?void 0:$.full_name)||e.away_team,m=d?n==null?void 0:n[d]:void 0,g=h?n==null?void 0:n[h]:void 0;if(g){const S=g.point;i.push(_e(e,"spread","away",g.price,`${h||e.away_team} ${_t(S)}`,S,c,o))}if(m){const S=m.point;i.push(_e(e,"spread","home",m.price,`${d||e.home_team} ${_t(S)}`,S,c,o))}return i}function qn(e,n,a,c){const o=[];return Object.entries(n).forEach(([i,d])=>{const h=i.toLowerCase()==="over"?"over":"under",m=`${i} ${Un(d.point)}`;o.push(_e(e,"total",h,d.price,m,d.point,a,c))}),o}function _e(e,n,a,c,o,i,d,h){const m=document.createElement("button");m.type="button",m.className="odds-chip",m.innerHTML=`${w(o)} <span>${w(Kn(c,d))}</span>`;const g={game_id:e.game_id,label:o,market:n,selection:a,price:Number(c)||0,point:i};return m.dataset.oddsSelection=JSON.stringify(g),h?m.addEventListener("click",v=>{v.stopPropagation(),h({...g,game:e})}):m.disabled=!0,m}function Vn(e,n){e.innerHTML="",e.appendChild(xt(n.away_team,"Away")),e.appendChild(xt(n.home_team,"Home"))}function xt(e,n){const a=document.createElement("section");a.className="boxscore-team";const c=document.createElement("h4");c.textContent=`${n}: ${e.name}${Number.isFinite(e.score)?` • ${e.score}`:""}`,a.appendChild(c);const o=document.createElement("div");o.className="boxscore-table-wrapper";const i=document.createElement("table");return i.className="boxscore-table",i.innerHTML=`
    <thead>
      <tr>
        <th>Player</th>
        <th>POS</th>
        <th>MIN</th>
        <th>FG</th>
        <th>3PT</th>
        <th>FT</th>
        <th>REB</th>
        <th>AST</th>
        <th>STL</th>
        <th>BLK</th>
        <th>TOV</th>
        <th>PTS</th>
      </tr>
    </thead>
    <tbody>
      ${e.players.map(d=>Wn(d)).join("")}
    </tbody>`,o.appendChild(i),a.appendChild(o),a}function Wn(e){const n=w(e.player_name||""),a=w(e.position||""),c=M(e.MINUTES,1),o=`${M(e.FGM)}/${M(e.FGA)}`,i=`${M(e.FG3M)}/${M(e.FG3A)}`,d=`${M(e.FTM)}/${M(e.FTA)}`,h=M(e.REB),m=M(e.AST),g=M(e.STL),v=M(e.BLK),$=M(e.TOV),S=M(e.PTS);return`
    <tr>
      <td>${n}</td>
      <td>${a}</td>
      <td>${c}</td>
      <td>${o}</td>
      <td>${i}</td>
      <td>${d}</td>
      <td>${h}</td>
      <td>${m}</td>
      <td>${g}</td>
      <td>${v}</td>
      <td>${$}</td>
      <td>${S}</td>
    </tr>`}function M(e,n=0){if(!Number.isFinite(e??NaN))return"0";const a=Math.pow(10,n);return String(Math.round((e??0)*a)/a).replace(/\.0+$/,"")}function _t(e){return e>0?`+${e}`:`${e}`}function Un(e){return e%1===0?e.toFixed(0):e.toString()}function Kn(e,n){return Number.isFinite(e)?n==="decimal"?be(e).toFixed(2):e>0?`+${e}`:`${e}`:"—"}function Gn(e,n,a,c,o,i,d,h){const{selections:m,bankroll:g}=n,v=e.querySelector("#bet-slip-stake"),$=e.querySelector("#bet-slip-kind"),S=e.querySelector("#bet-slip-odds-wrap"),J=e.querySelector("#bet-slip-odds"),D=e.querySelector("#bet-slip-profit-wrap"),ce=e.querySelector("#bet-slip-profit"),Q=e.querySelector("#bet-slip-payout"),U=e.querySelector("#bet-slip-place"),F=e.querySelector("#bet-slip-clear"),he=e.querySelector("#bet-slip-message"),K=e.querySelector("#bet-slip-selections"),P=Number(v.value||0),H=m.length>1;if(K.innerHTML="",m.length){const C=document.createElement("div");C.className="bet-card bet-card--slip";const G=sa(m,a),Y=st(m[0].price,a),y=`
      <div class="bet-card__header">
        <div class="bet-card__kind">${w(H?"Parlay":"Single")}</div>
        <div class="bet-card__price">${w(H?G:Y)}</div>
        <div class="bet-card__status muted">Pending</div>
      </div>`,q=m.map((L,te)=>Mt(L,a,te,!0)).join("");C.innerHTML=`${y}<div class="bet-card__legs">${q}</div>`,C.querySelectorAll(".bet-card__leg-remove").forEach(L=>{L.addEventListener("click",te=>{te.stopPropagation();const ne=Number(L.dataset.index);Number.isInteger(ne)&&h(ne)})}),K.appendChild(C)}else{const C=document.createElement("p");C.className="muted",C.textContent="Select odds from the scoreboard to build your slip.",K.appendChild(C)}$.textContent=H?"Parlay":"Single";const Z=m.reduce((C,G)=>C*be(G.price),1),ee=P>0?P*Z:0;Q.textContent=O(ee),S.classList.toggle("hidden",!H),D.classList.toggle("hidden",!H),H&&(J.textContent=at(Z,a),ce.textContent=O(Math.max(0,ee-P))),U.disabled=!(m.length&&P>0&&P<=(g.available||0));const R=P>(g.available||0)?"Stake exceeds available balance.":"";he.textContent=R||c,v.oninput=()=>o(Number(v.value||0)),U.onclick=i,F.onclick=d}function fe(e,n){const a=e.querySelector("#bankroll-available"),c=e.querySelector("#bankroll-pending"),o=e.querySelector("#bankroll-potential");a.textContent=O(n.available),c.textContent=O(n.pending_stake),o.textContent=O(n.pending_potential)}function Yn(e,n,a,c,o){e.innerHTML=Dt(a,"No pending bets.",!1,o),n.innerHTML=Dt(c,"No settled bets.",!0,o)}function zn(e){switch(e.market){case"moneyline":return e.label||(e.selection==="home"?"Home ML":"Away ML");case"spread":return`${jt(e.selection)} ${Jn(e.point)}`;case"total":return`${e.selection==="over"?"Over":"Under"} ${Qn(e.point)}`;default:return e.label||"Selection"}}function Jn(e){return e==null?"":e>0?`+${e}`:`${e}`}function Qn(e){return e==null?"":e%1===0?e.toFixed(0):e.toString()}function jt(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function Mt(e,n,a,c=!1){const o=e.label||zn(e),i=st(e.price,n),d=Xn(e),h=ea(e),m=document.createElement("div");m.className="bet-card__leg";const g=document.createElement("div");g.innerHTML=`
    <strong>${w(o)}</strong>
    ${d?`<div class="bet-card__context">${w(d)}</div>`:""}`,m.appendChild(g);const v=document.createElement("div");if(v.className="bet-card__leg-meta",v.innerHTML=`
    <span class="bet-card__leg-price">${w(i)}</span>
    ${h?`<span class="bet-card__leg-result ${h.toLowerCase()}">${w(h)}</span>`:""}`,m.appendChild(v),c&&Number.isInteger(a)){const S=document.createElement("button");S.type="button",S.className="bet-card__leg-remove",S.textContent="Remove",S.dataset.index=String(a),m.appendChild(S)}const $=document.createElement("div");return $.appendChild(m),$.innerHTML}function Xn(e){const n=Zn(e);if(!n)return"";const a=`${n.away_team} @ ${n.home_team}`,c=n.date?new Date(n.date).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"",o=n.time||"",i=[a];return c&&i.push(c),o&&i.push(o),i.join(" • ")}function Zn(e){const n=e.metadata;return n&&n.game||e.game}function ea(e){const n=e.metadata,a=n==null?void 0:n.result;return!a||typeof a!="string"?"":a==="won"?"Won":a==="lost"?"Lost":a==="void"?"Push":a.charAt(0).toUpperCase()+a.slice(1)}function Dt(e,n,a,c){return e.length?e.slice().sort((i,d)=>{const h=new Date(i.placed_at).getTime(),m=new Date(d.placed_at).getTime();return a?m-h:h-m}).map(i=>ta(i,c)).join(""):`<p class="muted">${w(n)}</p>`}function ta(e,n){var v;const a=Pt(e.legs),c=a!=null&&e.legs.length>1?at(a,n):st(((v=e.legs[0])==null?void 0:v.price)??0,n),o=na(e.status),i=`bet-card bet-card--${e.status}`,d=e.legs.map($=>Mt($,n)).join(""),h=e.status==="pending"?"Potential":"Payout",m=O(e.payout??0),g=aa(e.placed_at);return`
    <div class="${i}">
      <div class="bet-card__header">
        <div class="bet-card__kind">${w(jt(e.kind))}</div>
        <div class="bet-card__price">${w(c)}</div>
        <div class="bet-card__status">${w(o)}</div>
      </div>
      <div class="bet-card__legs">${d}</div>
      <dl class="bet-card__meta">
        <div><dt>Stake</dt><dd>${O(e.stake)}</dd></div>
        <div><dt>${w(h)}</dt><dd>${m}</dd></div>
        <div><dt>Placed</dt><dd>${w(g)}</dd></div>
      </dl>
    </div>`}function na(e){switch(e){case"won":return"Won";case"lost":return"Lost";case"void":return"Push";default:return"Pending"}}function aa(e){const n=new Date(e);return Number.isNaN(n.getTime())?e:n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function Pt(e){return e.length?e.reduce((n,a)=>n*be(a.price),1):null}function sa(e,n){const a=Pt(e);return a==null?"—":at(a,n)}function at(e,n){if(!Number.isFinite(e)||e<=0)return"—";if(n==="decimal")return e.toFixed(2);const a=Hn(e);return a>0?`+${a}`:`${a}`}function st(e,n){return Number.isFinite(e)?n==="decimal"?be(e).toFixed(2):e>0?`+${e}`:`${e}`:"—"}function oa(e){return e.away_score==null||e.home_score==null?null:e.home_score>e.away_score?"home":e.away_score>e.home_score?"away":null}function ra(e,n){const a=n.home_score,c=n.away_score;if(a==null||c==null)return"pending";switch(e.market){case"moneyline":{const o=oa(n);return o==null?"pending":e.selection===o?"won":"lost"}case"spread":{if(e.selection!=="home"&&e.selection!=="away"||e.point==null)return"void";const o=e.selection==="home"?a:c,i=e.selection==="home"?c:a,d=o+e.point;return Nt(d,i)?"void":d>i?"won":"lost"}case"total":{if(e.selection!=="over"&&e.selection!=="under"||e.point==null)return"void";const o=a+c;return Nt(o,e.point)?"void":e.selection==="over"?o>e.point?"won":"lost":o<e.point?"won":"lost"}default:return"void"}}function ca(e,n){const a=e.legs.map(c=>{const o=n.get(c.game_id)||n.get(String(c.game_id));return o?ra(c,o):"pending"});if(a.some(c=>c==="pending"))return{status:"pending"};if(e.kind==="single"){const c=a[0];if(c==="won"){const o=be(e.legs[0].price);return{status:"won",payout:+(e.stake*o).toFixed(2),legResults:a}}return c==="void"?{status:"void",payout:e.stake,legResults:a}:{status:"lost",payout:0,legResults:a}}if(a.some(c=>c==="lost"))return{status:"lost",payout:0,legResults:a};if(a.every(c=>c==="won")){const c=e.legs.reduce((i,d)=>i*be(d.price),1);return{status:"won",payout:+(e.stake*c).toFixed(2),legResults:a}}if(a.every(c=>c==="won"||c==="void")){const c=e.legs.reduce((i,d,h)=>i*(a[h]==="void"?1:be(d.price)),1);return{status:"won",payout:+(e.stake*c).toFixed(2),legResults:a}}return{status:"pending"}}function Nt(e,n,a=1e-9){return Math.abs(e-n)<a}const ia=["♠","♥","♦","♣"],la=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];let oe=[],re=0;const xe=[0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26],da=new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]),me=360/xe.length,ua=3200;function Pe(e){return e===0?"green":da.has(e)?"red":"black"}function fa(e){switch(e){case"green":return"#15803d";case"red":return"#b91c1c";default:return"#111827"}}async function ma(){const e=document.getElementById("scoreboard-list"),n=document.getElementById("scoreboard-date"),a=document.getElementById("date-prev"),c=document.getElementById("date-next"),o=document.getElementById("simulate-day"),i=document.getElementById("reset-game"),d=document.getElementById("scoreboard-current-date"),h=document.querySelector("header"),m=document.querySelector("aside"),g=document.getElementById("pending-bets"),v=document.getElementById("settled-bets"),$=document.getElementById("bets-toggle-pending"),S=document.getElementById("bets-toggle-settled"),J=document.getElementById("bet-panel-slip"),D=document.getElementById("bet-panel-history"),ce=document.getElementById("bet-panel-slip-view"),Q=document.getElementById("bet-panel-history-view"),U=document.getElementById("odds-format-american"),F=document.getElementById("odds-format-decimal"),he=document.getElementById("blackjack-stake"),K=document.getElementById("blackjack-deal"),P=document.getElementById("blackjack-hit"),H=document.getElementById("blackjack-stand"),Z=document.getElementById("blackjack-double"),ee=document.getElementById("blackjack-split"),R=document.getElementById("blackjack-status"),C=document.getElementById("roulette-stake"),G=document.getElementById("roulette-spin"),Y=document.getElementById("roulette-clear"),y=document.getElementById("roulette-status"),q=document.getElementById("roulette-wheel"),L=document.getElementById("roulette-ball"),te=document.getElementById("roulette-board"),ne=Array.from(document.querySelectorAll(".roulette-chip.denom")),x=await Ht();let _=await Cn();const ve=new Map;let I,j=!1;if(x!=null&&x.start_date){const t=new Set(x.dates||[]),s=x.start_date,r=_.currentDate;(!r||t.size>0&&r&&!t.has(r))&&(_=await Le({currentDate:s})),n&&(n.min=x.start_date,x.end_date&&(n.max=x.end_date))}let T=[],ke=[],De=[],B={available:_.bankroll,pending_stake:_.pendingStake,pending_potential:_.pendingPotential},Ne="pending",we="american",ie="slip",V="",u=null,le=(x==null?void 0:x.start_date)||_.currentDate;const ae=new Map,se=new Map;let ge=0,Ee=!1,Se=0;function ot(t){const s=_.currentDate;if(s&&!j&&((I==null?void 0:I.games.length)||0)>0){const r=new Date(s);if(new Date(t)>r){window.alert("Simulate the current day before advancing."),n.value=s;return}}_={..._,currentDate:t},Le({currentDate:t}),n.value=t,T=[],V="",A(),Re(t).catch(console.error)}async function Ht(){try{return await ln()}catch{return{dates:[],start_date:"",end_date:""}}}async function Re(t){let s=await Dn(t);if(!s)try{s=await dn(t),await _n(t,s)}catch{s={date:t,games:[]}}I=s;const r=await Ct(t);j=!!(r!=null&&r.simulated),!j&&s.games.length===0&&(j=!0,await Lt(t,{date:t,simulated:!0})),j&&s.games.length?await rt(s):await Ae(),await dt(),Te()}async function rt(t){const s=new Map(t.games.map(f=>[String(f.game_id),f])),l=(await Bt()).filter(f=>f.status==="pending");for(const f of l){const p=ca(f,s);if(p.status!=="pending"){const b=f.legs.map((k,E)=>{const ye=k.metadata||{},ue={...ye,result:p.legResults?p.legResults[E]:ye.result};return{...k,metadata:ue}});await xn(f.id,{status:p.status,payout:p.payout,legs:b})}}await Ae()}function Te(){if(!I)return;const t=I.games.length>0;Rn(e,I,{showFinalScores:j,oddsFormat:we,onOddsSelected:j?void 0:Vt,onRequestBoxscore:j?Rt:void 0}),At(_.currentDate,j,t),je(Ne)}async function Rt(t){const s=String(t);if(ve.has(s))return ve.get(s);const r=await Tn(t);if(r)return ve.set(s,r),r;const l=await un(t);return await Nn(t,l),ve.set(s,l),l}function At(t,s,r){o&&(o.disabled=s||!r,r?o.textContent=s?"Day Simulated":"Simulate Day":o.textContent="No Games"),c&&(c.disabled=r&&!s)}async function Ae(){const t=await Bt();ke=t.filter(b=>b.status==="pending"),De=t.filter(b=>b.status!=="pending");const s=ke.reduce((b,k)=>b+k.stake,0),r=ke.reduce((b,k)=>b+(k.payout||0),0),l=De.reduce((b,k)=>b+((k.payout||0)-k.stake),0),p=(_.initialBankroll??1e3)+l-s;B={available:p,pending_stake:s,pending_potential:r},await Le({bankroll:p,pendingStake:s,pendingPotential:r}),A()}function A(){fe(h,B),Gn(m,{selections:T,bankroll:B},we,V,t=>A(),Ot,Ft,qt),Yn(g,v,ke,De,we),je(Ne),Oe(),z()}async function Ot(){const t=document.getElementById("bet-slip-stake"),s=Number(t.value||0);if(!(s>0)||!T.length||s>B.available)return;const r=T.map(p=>({game_id:p.game_id,market:p.market,selection:p.selection,price:p.price,point:p.point,label:p.label,game:p.game,metadata:{...p.metadata||{},game:p.game||p.metadata&&p.metadata.game}})),l={placed_at:new Date().toISOString(),status:"pending",kind:T.length>1?"parlay":"single",stake:s,legs:r},f=T.reduce((p,b)=>p*(b.price?b.price>0?1+b.price/100:1+100/Math.abs(b.price):1),1);l.payout=+(s*f).toFixed(2),await Ln(l),T=[],V="",await Ae()}function Ft(){T=[],V="",A()}function qt(t){T.splice(t,1),V="",A()}function Vt(t){const s=String(t.game_id),r=T.filter(l=>String(l.game_id)===s);if(t.market==="total"){if(r.some(l=>l.market==="total")){V="Only one total selection per game.",A();return}}else if(r.some(l=>l.market==="moneyline"||l.market==="spread")){V="Only one moneyline or spread selection per game.",A();return}if(T.some(l=>l.game_id===t.game_id&&l.market===t.market&&l.selection===t.selection&&(l.point??null)===(t.point??null))){V="Selection already added.",A();return}V="",T.push(t),A()}function de(t){!Number.isFinite(t)||t===0||(B.available=Math.max(0,B.available+t),Le({bankroll:B.available}).then(s=>{_={..._,bankroll:s.bankroll}}).catch(()=>{}))}async function Wt(){if(!I||j)return;const t=_.currentDate;t&&(T=[],V="",A(),j=!0,await Lt(t,{date:t,simulated:!0,simulatedAt:new Date().toISOString()}),await rt(I),await dt(),Te())}const Ie=x.start_date||_.currentDate||new Date().toISOString().slice(0,10);n.value=Ie,n.onchange=()=>ot(n.value),a.onclick=()=>ct(-1),c.onclick=()=>ct(1),o&&(o.onclick=()=>Wt().catch(console.error)),i&&(i.onclick=()=>Ut(Ie).catch(console.error)),$&&($.onclick=()=>je("pending")),S&&(S.onclick=()=>je("settled")),U&&(U.onclick=()=>lt("american")),F&&(F.onclick=()=>lt("decimal")),K&&(K.onclick=()=>Kt()),P&&(P.onclick=()=>Gt()),H&&(H.onclick=()=>Yt()),Z&&(Z.onclick=()=>zt()),ee&&(ee.onclick=()=>Jt()),ne.forEach(t=>{t.onclick=()=>en(t)}),Y&&(Y.onclick=()=>tn()),J&&(J.onclick=()=>it("slip")),D&&(D.onclick=()=>it("history")),C&&(C.oninput=()=>{const t=Math.max(0,Number(C.value||0));C.value=Number.isFinite(t)?String(t):"0"}),G&&(G.onclick=()=>Xt()),await Re(Ie),R&&(R.textContent="Select a stake and deal."),y&&(y.textContent="Choose a chip, then tap the board."),sn(),an(),Be(),L&&(L.style.transform=`rotate(${me/2}deg) translateY(-82px)`);function ct(t){if(t>0&&!j&&((I==null?void 0:I.games.length)||0)>0){window.alert("Simulate the current day before advancing.");return}const s=n.value||Ie,r=new Date(s);r.setDate(r.getDate()+t),ot(r.toISOString().slice(0,10))}async function Ut(t){if(!window.confirm("Reset to season start? Current progress will remain but you will jump back to the first day."))return;const r=1e3;_=await Le({currentDate:t,bankroll:r,initialBankroll:r,pendingStake:0,pendingPotential:0}),n.value=t,T=[],j=!1,I=void 0,ve.clear(),ke=[],De=[],B={available:r,pending_stake:0,pending_potential:0},Ne="pending",V="",u=null,oe=[],re=0,R&&(R.textContent="Select a stake and deal."),he&&(he.value="10"),se.clear(),ie="slip",ge=0,ne.forEach(l=>{l.classList.remove("selected"),l.disabled=!1}),Y&&(Y.disabled=!1),Ee=!1,Se=0,q&&(q.style.transform="rotate(0deg)"),L&&(L.classList.remove("rolling"),L.style.transform=`rotate(${me/2}deg) translateY(-82px)`),ae.forEach(l=>l.classList.remove("active")),Be(),Ce(),Oe(),y&&(y.textContent="Choose a chip, then tap the board.",y.classList.add("muted")),A(),await In(),await jn(),await Mn(),await Pn(),Te(),await Re(t)}function je(t){Ne=t,$&&$.classList.toggle("active",t==="pending"),S&&S.classList.toggle("active",t==="settled"),g&&g.classList.toggle("hidden",t!=="pending"),v&&v.classList.toggle("hidden",t!=="settled")}function it(t){ie!==t&&(ie=t,Oe())}function Oe(){ce&&ce.classList.toggle("hidden",ie!=="slip"),Q&&Q.classList.toggle("hidden",ie!=="history"),J&&J.classList.toggle("active",ie==="slip"),D&&D.classList.toggle("active",ie==="history")}function lt(t){we!==t&&(we=t,U&&U.classList.toggle("active",t==="american"),F&&F.classList.toggle("active",t==="decimal"),Te(),A())}function Fe(t){if(t||(t=le),!d)return;if(!t){d.textContent="";return}const s=new Date(`${t}T00:00:00`);Number.isNaN(s.getTime())?d.textContent=t:d.textContent=s.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"})}async function dt(){if(!(x!=null&&x.dates)||!x.dates.length){le=_.currentDate,Fe(le);return}const t=[...x.dates].sort();for(const s of t){const r=await Ct(s);if(!(r!=null&&r.simulated)){le=s,Fe(le);return}}le=t[t.length-1],Fe(le)}function Kt(){if(!he||!R||!K)return;const t=Math.floor(Number(he.value||0));if(!(t>0)){R.textContent="Enter a valid stake.";return}if(t>B.available){R.textContent="Stake exceeds available balance.";return}(!oe.length||re>=6||oe.length<52)&&(oe=bt(),re=0),de(-t),fe(h,B);const s=[X(),X()],r=[X(),X()],l={cards:s,bet:t,status:"playing",doubled:!1,split:!1};u={hands:[l],activeHand:0,dealer:r,stake:t,inRound:!0,settled:!1,message:"Hit, Stand, Double, or Split when available."};const f=W(l.cards),p=W(r);if(f.isBlackjack){u.inRound=!1,u.settled=!0,p.isBlackjack?(l.status="settled",l.result="push",u.message="Both you and the dealer have blackjack. Push.",de(t)):(l.status="blackjack",l.result="win",u.message="Blackjack! Paid 3:2.",de(t*2.5)),fe(h,B),re+=1,z();return}if(p.isBlackjack){u.inRound=!1,u.settled=!0,l.status="settled",l.result="lose",u.message="Dealer has blackjack.",re+=1,z();return}z()}function Gt(){if(!u||!u.inRound)return;const t=$e();if(!t)return;t.cards.push(X());const s=W(t.cards);s.total>21?(t.status="bust",t.result="lose",u.message=`Hand ${u.activeHand+1} busts with ${s.total}.`,Me()):s.total===21?(t.status="stood",u.message=`Hand ${u.activeHand+1} shows 21.`,Me()):u.message=`Hand ${u.activeHand+1} totals ${s.total}.`,z()}function Yt(){if(!u||!u.inRound)return;const t=$e();if(!t)return;const s=W(t.cards);t.status="stood",u.message=`Hand ${u.activeHand+1} stands at ${s.total}.`,Me(),z()}function zt(){if(!u||!u.inRound)return;const t=$e();if(!t||!ft(t))return;de(-t.bet),fe(h,B),t.bet*=2,t.doubled=!0,t.cards.push(X());const s=W(t.cards);s.total>21?(t.status="bust",t.result="lose",u.message=`Hand ${u.activeHand+1} busts with ${s.total}.`):(t.status="stood",u.message=`Hand ${u.activeHand+1} doubles to ${s.total}.`),Me(),z()}function Jt(){if(!u||!u.inRound)return;const t=$e();if(!t||!mt(t))return;if(t.bet>B.available){u.message="Insufficient bankroll to split.",z();return}de(-t.bet),fe(h,B);const[s,r]=t.cards;t.cards=[s,X()],t.status="playing",t.split=!0;const l={cards:[r,X()],bet:t.bet,status:"playing",doubled:!1,split:!0};u.hands.splice(u.activeHand+1,0,l),u.message="Hands split. Play the first hand.",z()}function Me(){if(!u)return;const t=u,s=t.activeHand,r=t.hands.findIndex((f,p)=>p>s&&f.status==="playing");if(r!==-1){t.activeHand=r;return}const l=t.hands.findIndex(f=>f.status==="playing");if(l!==-1){t.activeHand=l;return}t.inRound=!1,Qt()}function Qt(){if(!u)return;const t=u;if(!t.hands.filter(l=>l.status!=="bust").length){ut();return}let r=W(t.dealer);for(;r.total<17||r.total===17&&r.isSoft;)t.dealer.push(X()),r=W(t.dealer);ut()}function ut(){if(!u)return;const t=u,s=W(t.dealer),r=[];let l=0;t.hands.forEach((f,p)=>{const b=W(f.cards);if(f.status==="bust"){f.result="lose",f.status="settled",r.push(`Hand ${p+1} busts (${b.total}).`);return}const k=!f.split&&f.cards.length===2&&b.isBlackjack;if(s.total>21){f.result="win",f.status=k?"blackjack":"settled",k?r.push(`Hand ${p+1} blackjack! Dealer busts. Paid 3:2.`):r.push(`Hand ${p+1} wins ${b.total} vs dealer bust.`),l+=f.bet*(k?2.5:2);return}b.total>s.total?(f.result="win",f.status=k?"blackjack":"settled",k?r.push(`Hand ${p+1} blackjack beats dealer ${s.total}. Paid 3:2.`):r.push(`Hand ${p+1} wins ${b.total} to ${s.total}.`),l+=f.bet*(k?2.5:2)):b.total<s.total?(f.result="lose",f.status="settled",r.push(`Hand ${p+1} loses ${b.total} to ${s.total}.`)):(f.result="push",f.status="settled",r.push(`Hand ${p+1} pushes at ${b.total}.`),l+=f.bet)}),u.message=r.join("<br/>"),u.settled=!0,u.inRound=!1,u.activeHand=-1,re+=1,re>=6&&(oe=[],re=0),l!==0&&(de(l),fe(h,B)),z()}function z(){if(!R||!K||!P||!H||!Z||!ee)return;const t=document.getElementById("blackjack-dealer-cards"),s=document.getElementById("blackjack-dealer-meta"),r=document.getElementById("blackjack-player-hands"),l=document.getElementById("blackjack-message");if(!u){R.textContent="Select a stake and deal.",K.disabled=!1,P.disabled=!0,H.disabled=!0,Z.disabled=!0,ee.disabled=!0,t&&(t.textContent="—"),s&&(s.textContent=""),r&&(r.innerHTML='<p class="muted">No active hands.</p>'),l&&(l.textContent="",l.classList.add("muted"));return}const f=$e(),p=!!(u.inRound&&f);K.disabled=u.inRound,P.disabled=!p,H.disabled=!p,Z.disabled=!p||!f||!ft(f),ee.disabled=!p||!f||!mt(f);const b=!u.inRound||u.settled,k=W(u.dealer);t&&(t.textContent=ht(u.dealer,b)),s&&(s.textContent=b?`Total: ${k.total}${k.isSoft?" (soft)":""}`:"Total: ?",s.classList.toggle("muted",!b)),r&&(r.innerHTML="",u.hands.forEach((E,ye)=>{const ue=document.createElement("div"),Ve=["blackjack-hand"];u.activeHand===ye&&u.inRound&&Ve.push("active"),E.status==="bust"&&Ve.push("bust"),ue.className=Ve.join(" ");const We=document.createElement("div");We.className="blackjack-cards",We.textContent=ht(E.cards,!0),ue.appendChild(We);const Ue=document.createElement("div");Ue.className="blackjack-hand-meta";const yt=W(E.cards),cn=[`Total: ${yt.total}`,yt.isSoft?"Soft":"",E.doubled?"Doubled":"",E.split?"Split":""].filter(Boolean);if(Ue.textContent=cn.join(" • "),ue.appendChild(Ue),E.result||E.status==="blackjack"){const Ke=document.createElement("div"),vt=E.status==="blackjack"?"blackjack":E.result??"win";Ke.className=`blackjack-hand-result ${vt}`,Ke.textContent=E.status==="blackjack"?"BLACKJACK":vt.toUpperCase(),ue.appendChild(Ke)}r.appendChild(ue)})),R.textContent=u.inRound?"Your move.":"Round complete.",l&&(u.message?(l.innerHTML=u.message,l.classList.remove("muted")):(l.textContent="",l.classList.add("muted")))}function Xt(){if(!C||!y||!q||Ee)return;const t=qe();if(!(t>0)){y.textContent="Place chips on the board before spinning.",y.classList.remove("muted");return}if(t>B.available){y.textContent="Stake exceeds available balance.",y.classList.remove("muted");return}const s=new Map(se);Ee=!0,y.textContent="Spinning...",y.classList.remove("muted"),ne.forEach(E=>{E.disabled=!0}),Y&&(Y.disabled=!0),G&&(G.disabled=!0),ae.forEach(E=>E.classList.remove("active")),L&&(L.classList.remove("rolling"),L.offsetWidth,L.classList.add("rolling"));const r=Math.floor(Math.random()*xe.length),l=xe[r],f=r*me+me/2,p=(360-Se%360+360)%360,b=4+Math.floor(Math.random()*3),k=(p-f+360)%360;Se=Se+b*360+k,q.style.transform=`rotate(${Se}deg)`,window.setTimeout(()=>{L&&(L.classList.remove("rolling"),L.style.transform=`rotate(${f}deg) translateY(-82px)`),nn(l);const E=rn(s,l);y.textContent=E.message,y.classList.toggle("muted",E.delta===0),E.delta!==0&&de(E.delta),fe(h,B),se.clear(),Ce(),Be(),ne.forEach(ye=>{ye.disabled=!1}),Y&&(Y.disabled=!1),G&&(G.disabled=!1),Ee=!1},ua)}function $e(){if(!u)return null;const t=u.activeHand;return t<0||t>=u.hands.length?null:u.hands[t]}function ft(t){return!(!(u!=null&&u.inRound)||t.status!=="playing"||t.cards.length!==2||t.doubled||B.available<t.bet)}function mt(t){if(!(u!=null&&u.inRound)||t.status!=="playing"||t.cards.length!==2||t.split||B.available<t.bet)return!1;const[s,r]=t.cards;return pt(s)===pt(r)}function pt(t){return t?t.startsWith("10")?"10":t.charAt(0):""}function bt(t=6){const s=[];for(let r=0;r<t;r+=1)s.push(...Zt());for(let r=s.length-1;r>0;r-=1){const l=Math.floor(Math.random()*(r+1));[s[r],s[l]]=[s[l],s[r]]}return s}function Zt(){const t=[];for(const s of la)for(const r of ia)t.push(`${s}${r}`);return t}function X(){return oe.length||(oe=bt()),oe.pop()??"??"}function W(t){let s=0,r=0;for(const p of t){const b=p.startsWith("10")?"10":p.charAt(0);b==="A"?(r+=1,s+=11):["K","Q","J"].includes(b)||b==="10"?s+=10:s+=Number(b)}let l=r;for(;s>21&&l>0;)s-=10,l-=1;const f=t.length===2&&s===21;return{total:s,isSoft:r>l,bust:s>21,isBlackjack:f}}function ht(t,s){return t.length?s?t.join(" "):`${t[0]} ??`:""}function en(t){const s=Number(t.dataset.amount||0);s>0&&(ge=s,ne.forEach(r=>r.classList.toggle("selected",r===t)),y&&(y.textContent=`Selected ${O(s)} chip. Tap the board to place it.`,y.classList.add("muted")))}function gt(t){if(Ee)return;if(!(ge>0)){y&&(y.textContent="Select a chip value before placing bets.",y.classList.remove("muted"));return}if(qe()+ge>B.available){y&&(y.textContent="Stake exceeds available balance.",y.classList.remove("muted"));return}se.set(t,(se.get(t)||0)+ge),Be(),Ce(),y&&(y.textContent=`Placed ${O(ge)} on ${t===0?"0":t}.`,y.classList.add("muted"))}function tn(){se.clear(),Be(),Ce(),y&&(y.textContent="Bets cleared. Select a chip and tap the board.",y.classList.add("muted"))}function Be(){C&&(C.value=String(qe()))}function qe(){let t=0;return se.forEach(s=>{t+=s}),t}function Ce(){ae.forEach((t,s)=>{const r=t.querySelector(".roulette-chip-stack");if(!r)return;const l=se.get(s)||0;l>0?(r.textContent=O(l),r.classList.add("active")):(r.textContent="",r.classList.remove("active"))})}function nn(t){ae.forEach(r=>r.classList.remove("active"));const s=ae.get(t);s&&s.classList.add("active")}function an(){if(!te)return;te.innerHTML="",ae.clear();const t=document.createElement("div");t.className="roulette-zero",t.dataset.number="0",t.innerHTML="<span>0</span>";const s=document.createElement("div");s.className="roulette-chip-stack",t.appendChild(s),t.addEventListener("click",()=>gt(0)),te.appendChild(t),ae.set(0,t);const r=document.createElement("div");r.className="roulette-grid";for(let l=11;l>=0;l-=1)for(let f=0;f<3;f+=1){const p=l*3+(3-f),b=document.createElement("div");b.className=`roulette-cell ${Pe(p)}`,b.dataset.number=String(p),b.innerHTML=`<span>${p}</span>`;const k=document.createElement("div");k.className="roulette-chip-stack",b.appendChild(k),b.addEventListener("click",()=>gt(p)),r.appendChild(b),ae.set(p,b)}te.appendChild(r),Ce()}function sn(){if(!q)return;let t=0;const s=[];for(const r of xe){const l=fa(Pe(r)),f=t,p=f+me;s.push(`${l} ${f.toFixed(4)}deg ${p.toFixed(4)}deg`),t=p}q.style.setProperty("--roulette-gradient",`conic-gradient(${s.join(", ")})`),on()}function on(){if(!q)return;let t=q.querySelector(".roulette-wheel-numbers");t&&t.remove(),t=document.createElement("div"),t.className="roulette-wheel-numbers",xe.forEach((s,r)=>{const l=r*me+me/2,f=document.createElement("span");f.className=`roulette-wheel-number roulette-wheel-number-${Pe(s)}`,f.textContent=String(s),f.style.transform=`rotate(${l}deg) translateY(-82px) rotate(${-l}deg)`,t.appendChild(f)}),q.appendChild(t)}function rn(t,s){const r=Array.from(t.values()).reduce((k,E)=>k+E,0),l=t.get(s)||0,f=Pe(s);let p=-r;l>0&&(p+=l*36);let b=`Ball lands on ${s} ${f==="green"?"GREEN":f.toUpperCase()}.`;return l>0?b+=` You win ${O(l*35)}.`:r>0&&(b+=` You lose ${O(r)}.`),{delta:p,message:b}}}ma();
