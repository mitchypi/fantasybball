(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=a(r);fetch(r.href,l)}})();const kt="./";async function jn(){const e=await fetch(`${kt}data/manifest.json`);if(!e.ok)throw new Error(`Manifest HTTP ${e.status}`);return e.json()}async function Rn(e){const n=await fetch(`${kt}data/scoreboard/${e}.json`);if(n.status===404)return{date:e,games:[]};if(!n.ok)throw new Error(`Scoreboard HTTP ${n.status}`);return n.json()}async function Hn(e){const n=await fetch(`${kt}data/boxscores/${e}.json`);if(!n.ok)throw new Error(`Boxscore HTTP ${n.status}`);return n.json()}const pt=(e,n)=>n.some(a=>e instanceof a);let At,Ft;function On(){return At||(At=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function An(){return Ft||(Ft=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bt=new WeakMap,ct=new WeakMap,Ye=new WeakMap;function Fn(e){const n=new Promise((a,i)=>{const r=()=>{e.removeEventListener("success",l),e.removeEventListener("error",d)},l=()=>{a(ve(e.result)),r()},d=()=>{i(e.error),r()};e.addEventListener("success",l),e.addEventListener("error",d)});return Ye.set(n,e),n}function Wn(e){if(bt.has(e))return;const n=new Promise((a,i)=>{const r=()=>{e.removeEventListener("complete",l),e.removeEventListener("error",d),e.removeEventListener("abort",d)},l=()=>{a(),r()},d=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",l),e.addEventListener("error",d),e.addEventListener("abort",d)});bt.set(e,n)}let gt={get(e,n,a){if(e instanceof IDBTransaction){if(n==="done")return bt.get(e);if(n==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return ve(e[n])},set(e,n,a){return e[n]=a,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function Xt(e){gt=e(gt)}function Vn(e){return An().includes(e)?function(...n){return e.apply(ht(this),n),ve(this.request)}:function(...n){return ve(e.apply(ht(this),n))}}function qn(e){return typeof e=="function"?Vn(e):(e instanceof IDBTransaction&&Wn(e),pt(e,On())?new Proxy(e,gt):e)}function ve(e){if(e instanceof IDBRequest)return Fn(e);if(ct.has(e))return ct.get(e);const n=qn(e);return n!==e&&(ct.set(e,n),Ye.set(n,e)),n}const ht=e=>Ye.get(e);function Un(e,n,{blocked:a,upgrade:i,blocking:r,terminated:l}={}){const d=indexedDB.open(e,n),h=ve(d);return i&&d.addEventListener("upgradeneeded",b=>{i(ve(d.result),b.oldVersion,b.newVersion,ve(d.transaction),b)}),a&&d.addEventListener("blocked",b=>a(b.oldVersion,b.newVersion,b)),h.then(b=>{l&&b.addEventListener("close",()=>l()),r&&b.addEventListener("versionchange",v=>r(v.oldVersion,v.newVersion,v))}).catch(()=>{}),h}const zn=["get","getKey","getAll","getAllKeys","count"],Kn=["put","add","delete","clear"],lt=new Map;function Wt(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(lt.get(n))return lt.get(n);const a=n.replace(/FromIndex$/,""),i=n!==a,r=Kn.includes(a);if(!(a in(i?IDBIndex:IDBObjectStore).prototype)||!(r||zn.includes(a)))return;const l=async function(d,...h){const b=this.transaction(d,r?"readwrite":"readonly");let v=b.store;return i&&(v=v.index(h.shift())),(await Promise.all([v[a](...h),r&&b.done]))[0]};return lt.set(n,l),l}Xt(e=>({...e,get:(n,a,i)=>Wt(n,a)||e.get(n,a,i),has:(n,a)=>!!Wt(n,a)||e.has(n,a)}));const Gn=["continue","continuePrimaryKey","advance"],Vt={},yt=new WeakMap,en=new WeakMap,Yn={get(e,n){if(!Gn.includes(n))return e[n];let a=Vt[n];return a||(a=Vt[n]=function(...i){yt.set(this,en.get(this)[n](...i))}),a}};async function*Jn(...e){let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...e)),!n)return;n=n;const a=new Proxy(n,Yn);for(en.set(a,n),Ye.set(a,ht(n));n;)yield a,n=await(yt.get(a)||n.continue()),yt.delete(a)}function qt(e,n){return n===Symbol.asyncIterator&&pt(e,[IDBIndex,IDBObjectStore,IDBCursor])||n==="iterate"&&pt(e,[IDBIndex,IDBObjectStore])}Xt(e=>({...e,get(n,a,i){return qt(n,a)?Jn:e.get(n,a,i)},has(n,a){return qt(n,a)||e.has(n,a)}}));const Zn="fantasybball",Qn=3;let ut=null;function T(){return ut||(ut=Un(Zn,Qn,{upgrade(e){e.objectStoreNames.contains("system")||e.createObjectStore("system",{keyPath:"key"}).put({key:"system",currentDate:new Date().toISOString().slice(0,10),bankroll:1e3,initialBankroll:1e3,pendingStake:0,pendingPotential:0,sportsbookWagered:0,sportsbookProfit:0,casinoWagered:0,casinoProfit:0}),e.objectStoreNames.contains("bets")||e.createObjectStore("bets",{keyPath:"id",autoIncrement:!0}),e.objectStoreNames.contains("scoreboards")||e.createObjectStore("scoreboards"),e.objectStoreNames.contains("boxscores")||e.createObjectStore("boxscores"),e.objectStoreNames.contains("simulations")||e.createObjectStore("simulations")}})),ut}async function Xn(){const e=await T(),n=await e.get("system","system");if(!n){const i={key:"system",currentDate:new Date().toISOString().slice(0,10),bankroll:1e3,initialBankroll:1e3,pendingStake:0,pendingPotential:0,sportsbookWagered:0,sportsbookProfit:0,casinoWagered:0,casinoProfit:0};return await e.put("system",i),i}const a={};if(n.sportsbookWagered==null&&(a.sportsbookWagered=0),n.sportsbookProfit==null&&(a.sportsbookProfit=0),n.casinoWagered==null&&(a.casinoWagered=0),n.casinoProfit==null&&(a.casinoProfit=0),Object.keys(a).length){const i={...n,...a};return await e.put("system",i),i}return n}async function es(e){const n=await T(),i={...await n.get("system","system"),...e};return await n.put("system",i),i}async function ts(e){const a=await(await T()).add("bets",e);return{...e,id:a}}async function Ut(){return await(await T()).transaction("bets").objectStore("bets").getAll()}async function ns(e,n){const a=await T(),i=await a.get("bets",e);i&&await a.put("bets",{...i,...n})}async function ss(e,n){await(await T()).put("scoreboards",n,e)}async function as(e){return(await T()).get("scoreboards",e)}async function os(e,n){await(await T()).put("boxscores",n,String(e))}async function rs(e){return(await T()).get("boxscores",String(e))}async function zt(e){return(await T()).get("simulations",e)}async function Kt(e,n){return await(await T()).put("simulations",n,e),n}async function is(){await(await T()).clear("bets")}async function cs(){await(await T()).clear("simulations")}async function ls(){await(await T()).clear("scoreboards")}async function us(){await(await T()).clear("boxscores")}function E(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function we(e){return Number.isFinite(e)?e>0?1+e/100:1+100/Math.abs(e):1}function ds(e){return!Number.isFinite(e)||e<=1?0:e>=2?Math.round((e-1)*100):Math.round(-100/(e-1))}function _(e,n="USD"){const a=Number(e)||0;return new Intl.NumberFormat(void 0,{style:"currency",currency:n}).format(a)}function fs(e,n,a={}){e.innerHTML="",e.classList.add("scoreboard-list");const i=n.games||[];if(!i.length){const r=document.createElement("li");r.className="score-card disabled",r.innerHTML='<div class="teams"><div class="team-row"><span>No games to show.</span></div></div>',e.appendChild(r);return}i.forEach(r=>{const l=document.createElement("li");l.className="score-card",l.dataset.gameId=String(r.game_id),l.dataset.date=n.date||"";const d=document.createElement("div");d.className="score-summary";const b=(a.showFinalScores??!0)&&r.simulated,v=b?r.away_score??"--":"--",w=b?r.home_score??"--":"--",$=b?r.status||"Final":"Awaiting simulation",C=b?"status-final":"status-upcoming";d.innerHTML=`
      <div class="teams">
        <div class="team-row"><span>${E(r.away_team||"")}</span><span>${E(String(v))}</span></div>
        <div class="team-row"><span>${E(r.home_team||"")}</span><span>${E(String(w))}</span></div>
      </div>
      <div class="meta">
        <div class="${C}">${E($)}</div>
        ${r.time?`<div>${E(r.time)}</div>`:""}
        ${r.period_display?`<div>${E(r.period_display)}</div>`:""}
      </div>
    `,l.appendChild(d);const ee=ms(r,a.oddsFormat??"american",a.onOddsSelected);if(ee&&l.appendChild(ee),a.onRequestBoxscore&&b){const P=document.createElement("div");P.className="score-detail",P.innerHTML='<p class="muted">Click to load the full box score.</p>',l.appendChild(P),d.addEventListener("click",()=>fe()),d.addEventListener("keydown",te=>{(te.key==="Enter"||te.key===" ")&&(te.preventDefault(),fe())}),d.setAttribute("role","button"),d.setAttribute("tabindex","0");async function fe(){var J;if(l.classList.contains("active")){l.classList.remove("active"),P.innerHTML='<p class="muted">Click to load the full box score.</p>';return}l.classList.add("active"),P.innerHTML='<p class="muted">Loading box score…</p>';try{const U=await((J=a.onRequestBoxscore)==null?void 0:J.call(a,r.game_id,n.date));if(!U){P.innerHTML='<p class="muted">Box score unavailable.</p>';return}hs(P,U)}catch(U){P.innerHTML=`<p class="error">${E(U.message||"Unable to load box score.")}</p>`}}}e.appendChild(l)})}function ms(e,n,a){const i=e==null?void 0:e.odds;if(!i||!i.markets)return null;const r=document.createElement("div");r.className="odds-preview";const l=i.markets;return l.moneyline&&r.appendChild(dt("Moneyline",ps(e,l.moneyline,i,n,a))),l.spread&&r.appendChild(dt("Spread",bs(e,l.spread,i,n,a))),l.total&&r.appendChild(dt("Total",gs(e,l.total,n,a))),r.childNodes.length?r:null}function dt(e,n){if(!n.length)return document.createElement("div");const a=document.createElement("div");a.className="odds-market";const i=document.createElement("div");i.className="odds-market__title",i.textContent=e;const r=document.createElement("div");return r.className="odds-market__chips",n.forEach(l=>r.appendChild(l)),a.append(i,r),a}function ps(e,n,a,i,r){var w,$;const l=[],d=((w=a==null?void 0:a.home_team)==null?void 0:w.full_name)||e.home_team,h=(($=a==null?void 0:a.away_team)==null?void 0:$.full_name)||e.away_team,b=d?n==null?void 0:n[d]:void 0,v=h?n==null?void 0:n[h]:void 0;return v&&l.push(De(e,"moneyline","away",v.price,`${h||e.away_team} ML`,void 0,i,r)),b&&l.push(De(e,"moneyline","home",b.price,`${d||e.home_team} ML`,void 0,i,r)),l}function bs(e,n,a,i,r){var w,$;const l=[],d=((w=a==null?void 0:a.home_team)==null?void 0:w.full_name)||e.home_team,h=(($=a==null?void 0:a.away_team)==null?void 0:$.full_name)||e.away_team,b=d?n==null?void 0:n[d]:void 0,v=h?n==null?void 0:n[h]:void 0;if(v){const C=v.point;l.push(De(e,"spread","away",v.price,`${h||e.away_team} ${Yt(C)}`,C,i,r))}if(b){const C=b.point;l.push(De(e,"spread","home",b.price,`${d||e.home_team} ${Yt(C)}`,C,i,r))}return l}function gs(e,n,a,i){const r=[];return Object.entries(n).forEach(([l,d])=>{const h=l.toLowerCase()==="over"?"over":"under",b=`${l} ${ks(d.point)}`;r.push(De(e,"total",h,d.price,b,d.point,a,i))}),r}function De(e,n,a,i,r,l,d,h){const b=document.createElement("button");b.type="button",b.className="odds-chip",b.innerHTML=`${E(r)} <span>${E(vs(i,d))}</span>`;const v={game_id:e.game_id,label:r,market:n,selection:a,price:Number(i)||0,point:l};return b.dataset.oddsSelection=JSON.stringify(v),h?b.addEventListener("click",w=>{w.stopPropagation(),h({...v,game:e})}):b.disabled=!0,b}function hs(e,n){e.innerHTML="",e.appendChild(Gt(n.away_team,"Away")),e.appendChild(Gt(n.home_team,"Home"))}function Gt(e,n){const a=document.createElement("section");a.className="boxscore-team";const i=document.createElement("h4");i.textContent=`${n}: ${e.name}${Number.isFinite(e.score)?` • ${e.score}`:""}`,a.appendChild(i);const r=document.createElement("div");r.className="boxscore-table-wrapper";const l=document.createElement("table");return l.className="boxscore-table",l.innerHTML=`
    <thead>
      <tr>
        <th>Player</th>
        <th>POS</th>
        <th>MIN</th>
        <th>FG</th>
        <th>3PT</th>
        <th>FT</th>
        <th>REB</th>
        <th>AST</th>
        <th>STL</th>
        <th>BLK</th>
        <th>TOV</th>
        <th>PTS</th>
      </tr>
    </thead>
    <tbody>
      ${e.players.map(d=>ys(d)).join("")}
    </tbody>`,r.appendChild(l),a.appendChild(r),a}function ys(e){const n=E(e.player_name||""),a=E(e.position||""),i=H(e.MINUTES,1),r=`${H(e.FGM)}/${H(e.FGA)}`,l=`${H(e.FG3M)}/${H(e.FG3A)}`,d=`${H(e.FTM)}/${H(e.FTA)}`,h=H(e.REB),b=H(e.AST),v=H(e.STL),w=H(e.BLK),$=H(e.TOV),C=H(e.PTS);return`
    <tr>
      <td>${n}</td>
      <td>${a}</td>
      <td>${i}</td>
      <td>${r}</td>
      <td>${l}</td>
      <td>${d}</td>
      <td>${h}</td>
      <td>${b}</td>
      <td>${v}</td>
      <td>${w}</td>
      <td>${$}</td>
      <td>${C}</td>
    </tr>`}function H(e,n=0){if(!Number.isFinite(e??NaN))return"0";const a=Math.pow(10,n);return String(Math.round((e??0)*a)/a).replace(/\.0+$/,"")}function Yt(e){return e>0?`+${e}`:`${e}`}function ks(e){return e%1===0?e.toFixed(0):e.toString()}function vs(e,n){return Number.isFinite(e)?n==="decimal"?we(e).toFixed(2):e>0?`+${e}`:`${e}`:"—"}function Jt(e,n){e.classList.toggle("value-positive",n>0),e.classList.toggle("value-negative",n<0)}function ws(e,n,a,i,r,l,d,h){const{selections:b,bankroll:v}=n,w=e.querySelector("#bet-slip-stake"),$=e.querySelector("#bet-slip-kind"),C=e.querySelector("#bet-slip-odds-wrap"),ee=e.querySelector("#bet-slip-odds"),P=e.querySelector("#bet-slip-profit-wrap"),fe=e.querySelector("#bet-slip-profit"),te=e.querySelector("#bet-slip-payout"),J=e.querySelector("#bet-slip-place"),U=e.querySelector("#bet-slip-clear"),Se=e.querySelector("#bet-slip-message"),Z=e.querySelector("#bet-slip-selections"),O=Number(w.value||0),A=b.length>1;if(Z.innerHTML="",b.length){const L=document.createElement("div");L.className="bet-card bet-card--slip";const ne=Ps(b,a),Me=wt(b[0].price,a),Je=`
      <div class="bet-card__header">
        <div class="bet-card__kind">${E(A?"Parlay":"Single")}</div>
        <div class="bet-card__price">${E(A?ne:Me)}</div>
        <div class="bet-card__status muted">Pending</div>
      </div>`,ie=b.map((M,f)=>nn(M,a,f,!0)).join("");L.innerHTML=`${Je}<div class="bet-card__legs">${ie}</div>`,L.querySelectorAll(".bet-card__leg-remove").forEach(M=>{M.addEventListener("click",f=>{f.stopPropagation();const W=Number(M.dataset.index);Number.isInteger(W)&&h(W)})}),Z.appendChild(L)}else{const L=document.createElement("p");L.className="muted",L.textContent="Select odds from the scoreboard to build your slip.",Z.appendChild(L)}$.textContent=A?"Parlay":"Single";const oe=b.reduce((L,ne)=>L*we(ne.price),1),re=O>0?O*oe:0;te.textContent=_(re),C.classList.toggle("hidden",!A),P.classList.toggle("hidden",!A),A&&(ee.textContent=vt(oe,a),fe.textContent=_(Math.max(0,re-O))),J.disabled=!(b.length&&O>0&&O<=(v.available||0));const F=O>(v.available||0)?"Stake exceeds available balance.":"";Se.textContent=F||i,w.oninput=()=>r(Number(w.value||0)),J.onclick=l,U.onclick=d}function Pe(e,n,a,i){const r=e.querySelector("#bankroll-available"),l=e.querySelector("#bankroll-pending"),d=e.querySelector("#bankroll-potential"),h=e.querySelector("#sportsbook-wagered"),b=e.querySelector("#sportsbook-profit"),v=e.querySelector("#casino-wagered"),w=e.querySelector("#casino-profit");r.textContent=_(n.available),l.textContent=_(n.pending_stake),d.textContent=_(n.pending_potential),h&&(h.textContent=_(a.wagered)),b&&(b.textContent=_(a.profit),Jt(b,a.profit)),v&&(v.textContent=_(i.wagered)),w&&(w.textContent=_(i.profit),Jt(w,i.profit))}function Ss(e,n,a,i,r){e.innerHTML=Zt(a,"No pending bets.",!1,r),n.innerHTML=Zt(i,"No settled bets.",!0,r)}function Es(e){switch(e.market){case"moneyline":return e.label||(e.selection==="home"?"Home ML":"Away ML");case"spread":return`${tn(e.selection)} ${Bs(e.point)}`;case"total":return`${e.selection==="over"?"Over":"Under"} ${Cs(e.point)}`;default:return e.label||"Selection"}}function Bs(e){return e==null?"":e>0?`+${e}`:`${e}`}function Cs(e){return e==null?"":e%1===0?e.toFixed(0):e.toString()}function tn(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function nn(e,n,a,i=!1){const r=e.label||Es(e),l=wt(e.price,n),d=$s(e),h=xs(e),b=document.createElement("div");b.className="bet-card__leg";const v=document.createElement("div");v.innerHTML=`
    <strong>${E(r)}</strong>
    ${d?`<div class="bet-card__context">${E(d)}</div>`:""}`,b.appendChild(v);const w=document.createElement("div");if(w.className="bet-card__leg-meta",w.innerHTML=`
    <span class="bet-card__leg-price">${E(l)}</span>
    ${h?`<span class="bet-card__leg-result ${h.toLowerCase()}">${E(h)}</span>`:""}`,b.appendChild(w),i&&Number.isInteger(a)){const C=document.createElement("button");C.type="button",C.className="bet-card__leg-remove",C.textContent="Remove",C.dataset.index=String(a),b.appendChild(C)}const $=document.createElement("div");return $.appendChild(b),$.innerHTML}function $s(e){const n=Ls(e);if(!n)return"";const a=`${n.away_team} @ ${n.home_team}`,i=n.date?new Date(n.date).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"",r=n.time||"",l=[a];return i&&l.push(i),r&&l.push(r),l.join(" • ")}function Ls(e){const n=e.metadata;return n&&n.game||e.game}function xs(e){const n=e.metadata,a=n==null?void 0:n.result;return!a||typeof a!="string"?"":a==="won"?"Won":a==="lost"?"Lost":a==="void"?"Push":a.charAt(0).toUpperCase()+a.slice(1)}function Zt(e,n,a,i){return e.length?e.slice().sort((l,d)=>{const h=new Date(l.placed_at).getTime(),b=new Date(d.placed_at).getTime();return a?b-h:h-b}).map(l=>_s(l,i)).join(""):`<p class="muted">${E(n)}</p>`}function _s(e,n){var w;const a=sn(e.legs),i=a!=null&&e.legs.length>1?vt(a,n):wt(((w=e.legs[0])==null?void 0:w.price)??0,n),r=Ns(e.status),l=`bet-card bet-card--${e.status}`,d=e.legs.map($=>nn($,n)).join(""),h=e.status==="pending"?"Potential":"Payout",b=_(e.payout??0),v=Is(e.placed_at);return`
    <div class="${l}">
      <div class="bet-card__header">
        <div class="bet-card__kind">${E(tn(e.kind))}</div>
        <div class="bet-card__price">${E(i)}</div>
        <div class="bet-card__status">${E(r)}</div>
      </div>
      <div class="bet-card__legs">${d}</div>
      <dl class="bet-card__meta">
        <div><dt>Stake</dt><dd>${_(e.stake)}</dd></div>
        <div><dt>${E(h)}</dt><dd>${b}</dd></div>
        <div><dt>Placed</dt><dd>${E(v)}</dd></div>
      </dl>
    </div>`}function Ns(e){switch(e){case"won":return"Won";case"lost":return"Lost";case"void":return"Push";default:return"Pending"}}function Is(e){const n=new Date(e);return Number.isNaN(n.getTime())?e:n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function sn(e){return e.length?e.reduce((n,a)=>n*we(a.price),1):null}function Ps(e,n){const a=sn(e);return a==null?"—":vt(a,n)}function vt(e,n){if(!Number.isFinite(e)||e<=0)return"—";if(n==="decimal")return e.toFixed(2);const a=ds(e);return a>0?`+${a}`:`${a}`}function wt(e,n){return Number.isFinite(e)?n==="decimal"?we(e).toFixed(2):e>0?`+${e}`:`${e}`:"—"}function Ts(e){return e.away_score==null||e.home_score==null?null:e.home_score>e.away_score?"home":e.away_score>e.home_score?"away":null}function Ds(e,n){const a=n.home_score,i=n.away_score;if(a==null||i==null)return"pending";switch(e.market){case"moneyline":{const r=Ts(n);return r==null?"pending":e.selection===r?"won":"lost"}case"spread":{if(e.selection!=="home"&&e.selection!=="away"||e.point==null)return"void";const r=e.selection==="home"?a:i,l=e.selection==="home"?i:a,d=r+e.point;return Qt(d,l)?"void":d>l?"won":"lost"}case"total":{if(e.selection!=="over"&&e.selection!=="under"||e.point==null)return"void";const r=a+i;return Qt(r,e.point)?"void":e.selection==="over"?r>e.point?"won":"lost":r<e.point?"won":"lost"}default:return"void"}}function Ms(e,n){const a=e.legs.map(i=>{const r=n.get(i.game_id)||n.get(String(i.game_id));return r?Ds(i,r):"pending"});if(a.some(i=>i==="pending"))return{status:"pending"};if(e.kind==="single"){const i=a[0];if(i==="won"){const r=we(e.legs[0].price);return{status:"won",payout:+(e.stake*r).toFixed(2),legResults:a}}return i==="void"?{status:"void",payout:e.stake,legResults:a}:{status:"lost",payout:0,legResults:a}}if(a.some(i=>i==="lost"))return{status:"lost",payout:0,legResults:a};if(a.every(i=>i==="won")){const i=e.legs.reduce((l,d)=>l*we(d.price),1);return{status:"won",payout:+(e.stake*i).toFixed(2),legResults:a}}if(a.every(i=>i==="won"||i==="void")){const i=e.legs.reduce((l,d,h)=>l*(a[h]==="void"?1:we(d.price)),1);return{status:"won",payout:+(e.stake*i).toFixed(2),legResults:a}}return{status:"pending"}}function Qt(e,n,a=1e-9){return Math.abs(e-n)<a}const js=["♠","♥","♦","♣"],Rs=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];let ue=[],de=0;const Te=["0","32","15","19","4","21","2","25","17","34","6","27","13","36","11","30","8","23","10","5","24","16","33","1","20","14","31","9","22","18","29","7","28","12","35","3","26"],St=new Set(["1","3","5","7","9","12","14","16","18","19","21","23","25","27","30","32","34","36"]),ke=360/Te.length,Hs=3200,Y=Array.from({length:36},(e,n)=>String(n+1)),ft={column1:Y.filter(e=>(Number(e)-1)%3===0),column2:Y.filter(e=>(Number(e)-1)%3===1),column3:Y.filter(e=>(Number(e)-1)%3===2)},mt={dozen1:Y.filter(e=>Number(e)<=12),dozen2:Y.filter(e=>Number(e)>=13&&Number(e)<=24),dozen3:Y.filter(e=>Number(e)>=25)},Os=Y.filter(e=>Number(e)%2===0),As=Y.filter(e=>Number(e)%2===1),Fs=Y.filter(e=>Number(e)<=18),Ws=Y.filter(e=>Number(e)>=19),Vs=Y.filter(e=>!St.has(e)),qs=["0","1","2","3"],Us=new Set(["0-1","0-2","0-3"]),zs={red:{label:"Red",numbers:Array.from(St),payout:1},black:{label:"Black",numbers:Vs,payout:1},odd:{label:"Odd",numbers:As,payout:1},even:{label:"Even",numbers:Os,payout:1},low:{label:"Low (1-18)",numbers:Fs,payout:1},high:{label:"High (19-36)",numbers:Ws,payout:1},dozen1:{label:"1st 12",numbers:mt.dozen1,payout:2},dozen2:{label:"2nd 12",numbers:mt.dozen2,payout:2},dozen3:{label:"3rd 12",numbers:mt.dozen3,payout:2},column1:{label:"Column 1",numbers:ft.column1,payout:2},column2:{label:"Column 2",numbers:ft.column2,payout:2},column3:{label:"Column 3",numbers:ft.column3,payout:2}};function Ge(e){return e==="0"?"green":St.has(e)?"red":"black"}function Ks(e){switch(e){case"green":return"#15803d";case"red":return"#b91c1c";default:return"#111827"}}async function Gs(){const e=document.getElementById("scoreboard-list"),n=document.getElementById("scoreboard-date"),a=document.getElementById("date-prev"),i=document.getElementById("date-next"),r=document.getElementById("simulate-day"),l=document.getElementById("reset-game"),d=document.getElementById("scoreboard-current-date"),h=document.querySelector("header"),b=document.querySelector("aside"),v=document.getElementById("pending-bets"),w=document.getElementById("settled-bets"),$=document.getElementById("bets-toggle-pending"),C=document.getElementById("bets-toggle-settled"),ee=document.getElementById("bet-panel-slip"),P=document.getElementById("bet-panel-history"),fe=document.getElementById("bet-panel-slip-view"),te=document.getElementById("bet-panel-history-view"),J=document.getElementById("odds-format-american"),U=document.getElementById("odds-format-decimal"),Se=document.getElementById("blackjack-stake"),Z=document.getElementById("blackjack-deal"),O=document.getElementById("blackjack-hit"),A=document.getElementById("blackjack-stand"),oe=document.getElementById("blackjack-double"),re=document.getElementById("blackjack-split"),F=document.getElementById("blackjack-status"),L=document.getElementById("roulette-stake"),ne=document.getElementById("roulette-inside-type"),Me=document.getElementById("roulette-top-line"),Je=Array.from(document.querySelectorAll("[data-outside-bet]")),ie=document.getElementById("roulette-spin"),M=document.getElementById("roulette-clear"),f=document.getElementById("roulette-status"),W=document.getElementById("roulette-wheel"),V=document.getElementById("roulette-ball"),je=document.getElementById("roulette-board"),I=await an();let B=await Xn();const Ee=new Map;let j,R=!1;if(I!=null&&I.start_date){const t=new Set(I.dates||[]),s=I.start_date,o=B.currentDate;(!o||t.size>0&&o&&!t.has(o))&&(B=await He({currentDate:s})),n&&(n.min=I.start_date,I.end_date&&(n.max=I.end_date))}let D=[],Be=[],Ce=[],x={available:B.bankroll??B.initialBankroll??0,pending_stake:B.pendingStake??0,pending_potential:B.pendingPotential??0},se={wagered:B.sportsbookWagered??0,profit:B.sportsbookProfit??0},Q={wagered:B.casinoWagered??0,profit:B.casinoProfit??0},Re="pending",$e="american",me="slip",z="",m=null,pe=(I==null?void 0:I.start_date)||B.currentDate;const ce=new Map,le=new Map;let K=10;if(L){const t=Number(L.value||10);K=Number.isFinite(t)&&t>0?t:10,L.value=String(K)}let Ze=ne?ne.value:"straight",S={},Le=!1,xe=0;async function He(t){const s=await es(t);return B=s,s}function Oe(t){const s={bankroll:x.available,pendingStake:x.pending_stake,pendingPotential:x.pending_potential,sportsbookWagered:se.wagered,sportsbookProfit:se.profit,casinoWagered:Q.wagered,casinoProfit:Q.profit,...t};He(s).catch(()=>{})}function Ae(t){t>0&&(Q.wagered+=t,Pe(h,x,se,Q),Oe())}function Et(t){const s=B.currentDate;if(s&&!R&&((j==null?void 0:j.games.length)||0)>0){const o=new Date(s);if(new Date(t)>o){window.alert("Simulate the current day before advancing."),n.value=s;return}}B={...B,currentDate:t},He({currentDate:t}).catch(()=>{}),n.value=t,D=[],z="",q(),Qe(t).catch(console.error)}async function an(){try{return await jn()}catch{return{dates:[],start_date:"",end_date:""}}}async function Qe(t){let s=await as(t);if(!s)try{s=await Rn(t),await ss(t,s)}catch{s={date:t,games:[]}}j=s;const o=await zt(t);R=!!(o!=null&&o.simulated),!R&&s.games.length===0&&(R=!0,await Kt(t,{date:t,simulated:!0})),R&&s.games.length?await Bt(s):await Xe(),await xt(),Fe()}async function Bt(t){const s=new Map(t.games.map(u=>[String(u.game_id),u])),c=(await Ut()).filter(u=>u.status==="pending");for(const u of c){const p=Ms(u,s);if(p.status!=="pending"){const y=u.legs.map((k,g)=>{const N=k.metadata||{},ye={...N,result:p.legResults?p.legResults[g]:N.result};return{...k,metadata:ye}});await ns(u.id,{status:p.status,payout:p.payout,legs:y})}}await Xe()}function Fe(){if(!j)return;const t=j.games.length>0;fs(e,j,{showFinalScores:R,oddsFormat:$e,onOddsSelected:R?void 0:dn,onRequestBoxscore:R?on:void 0}),rn(B.currentDate,R,t),Ve(Re)}async function on(t){const s=String(t);if(Ee.has(s))return Ee.get(s);const o=await rs(t);if(o)return Ee.set(s,o),o;const c=await Hn(t);return await os(t,c),Ee.set(s,c),c}function rn(t,s,o){r&&(r.disabled=s||!o,o?r.textContent=s?"Day Simulated":"Simulate Day":r.textContent="No Games"),i&&(i.disabled=o&&!s)}async function Xe(){const t=await Ut();Be=t.filter(g=>g.status==="pending"),Ce=t.filter(g=>g.status!=="pending");const s=Be.reduce((g,N)=>g+N.stake,0),o=Be.reduce((g,N)=>g+(N.payout||0),0),c=Ce.reduce((g,N)=>g+((N.payout||0)-N.stake),0),p=(B.initialBankroll??1e3)+c-s;x={available:p,pending_stake:s,pending_potential:o};const y=t.reduce((g,N)=>g+N.stake,0),k=Ce.reduce((g,N)=>g+((N.payout||0)-N.stake),0);se={wagered:y,profit:k},B={...B,bankroll:p,pendingStake:s,pendingPotential:o,sportsbookWagered:y,sportsbookProfit:k},Oe(),q()}function q(){Pe(h,x,se,Q),ws(b,{selections:D,bankroll:x},$e,z,t=>q(),cn,ln,un),Ss(v,w,Be,Ce,$e),Ve(Re),et(),X()}async function cn(){const t=document.getElementById("bet-slip-stake"),s=Number(t.value||0);if(!(s>0)||!D.length||s>x.available)return;const o=D.map(p=>({game_id:p.game_id,market:p.market,selection:p.selection,price:p.price,point:p.point,label:p.label,game:p.game,metadata:{...p.metadata||{},game:p.game||p.metadata&&p.metadata.game}})),c={placed_at:new Date().toISOString(),status:"pending",kind:D.length>1?"parlay":"single",stake:s,legs:o},u=D.reduce((p,y)=>p*(y.price?y.price>0?1+y.price/100:1+100/Math.abs(y.price):1),1);c.payout=+(s*u).toFixed(2),await ts(c),D=[],z="",await Xe()}function ln(){D=[],z="",q()}function un(t){D.splice(t,1),z="",q()}function dn(t){const s=String(t.game_id),o=D.filter(c=>String(c.game_id)===s);if(t.market==="total"){if(o.some(c=>c.market==="total")){z="Only one total selection per game.",q();return}}else if(o.some(c=>c.market==="moneyline"||c.market==="spread")){z="Only one moneyline or spread selection per game.",q();return}if(D.some(c=>c.game_id===t.game_id&&c.market===t.market&&c.selection===t.selection&&(c.point??null)===(t.point??null))){z="Selection already added.",q();return}z="",D.push(t),q()}function be(t){!Number.isFinite(t)||t===0||(x.available=Math.max(0,x.available+t),Q.profit+=t,Pe(h,x,se,Q),Oe())}async function fn(){if(!j||R)return;const t=B.currentDate;t&&(D=[],z="",q(),R=!0,await Kt(t,{date:t,simulated:!0,simulatedAt:new Date().toISOString()}),await Bt(j),await xt(),Fe())}const We=I.start_date||B.currentDate||new Date().toISOString().slice(0,10);n.value=We,n.onchange=()=>Et(n.value),a.onclick=()=>Ct(-1),i.onclick=()=>Ct(1),r&&(r.onclick=()=>fn().catch(console.error)),l&&(l.onclick=()=>mn(We).catch(console.error)),$&&($.onclick=()=>Ve("pending")),C&&(C.onclick=()=>Ve("settled")),J&&(J.onclick=()=>Lt("american")),U&&(U.onclick=()=>Lt("decimal")),Z&&(Z.onclick=()=>pn()),O&&(O.onclick=()=>bn()),A&&(A.onclick=()=>gn()),oe&&(oe.onclick=()=>hn()),re&&(re.onclick=()=>yn()),M&&(M.onclick=()=>Ln()),ee&&(ee.onclick=()=>$t("slip")),P&&(P.onclick=()=>$t("history")),L&&(L.oninput=()=>{const t=Math.max(1,Number(L.value||0));K=Number.isFinite(t)?t:1,L.value=String(K),f&&(f.textContent=`Stake set to ${_(K)}.`,f.classList.add("muted"))}),ne&&(ne.onchange=()=>{Ze=ne.value||"straight",S={},f&&(f.textContent=`Inside bet set to ${Bn(Ze)}.`,f.classList.add("muted"))}),Me&&(Me.onclick=()=>En()),Je.forEach(t=>{const s=t.dataset.outsideBet;s&&(t.onclick=()=>Sn(s))}),ie&&(ie.onclick=()=>vn()),await Qe(We),F&&(F.textContent="Select a stake and deal."),f&&(f.textContent="Enter a stake, then tap the board."),Pn(),In(),Ue(),V&&(V.style.transform=`rotate(${ke/2}deg) translateY(-82px)`);function Ct(t){if(t>0&&!R&&((j==null?void 0:j.games.length)||0)>0){window.alert("Simulate the current day before advancing.");return}const s=n.value||We,o=new Date(s);o.setDate(o.getDate()+t),Et(o.toISOString().slice(0,10))}async function mn(t){if(!window.confirm("Reset to season start? Current progress will remain but you will jump back to the first day."))return;const o=1e3;B=await He({currentDate:t,bankroll:o,initialBankroll:o,pendingStake:0,pendingPotential:0,sportsbookWagered:0,sportsbookProfit:0,casinoWagered:0,casinoProfit:0}),n.value=t,D=[],R=!1,j=void 0,Ee.clear(),Be=[],Ce=[],x={available:o,pending_stake:0,pending_potential:0},se={wagered:0,profit:0},Q={wagered:0,profit:0},Re="pending",z="",m=null,ue=[],de=0,F&&(F.textContent="Select a stake and deal."),Se&&(Se.value="10"),le.clear(),me="slip",M&&(M.disabled=!1),Le=!1,xe=0,W&&(W.style.transform="rotate(0deg)"),V&&(V.classList.remove("rolling"),V.style.transform=`rotate(${ke/2}deg) translateY(-82px)`),ce.forEach(c=>c.classList.remove("active")),Ue(),Ie(),et(),f&&(f.textContent="Enter a stake, then tap the board.",f.classList.add("muted")),q(),await is(),await cs(),await ls(),await us(),Fe(),await Qe(t)}function Ve(t){Re=t,$&&$.classList.toggle("active",t==="pending"),C&&C.classList.toggle("active",t==="settled"),v&&v.classList.toggle("hidden",t!=="pending"),w&&w.classList.toggle("hidden",t!=="settled")}function $t(t){me!==t&&(me=t,et())}function et(){fe&&fe.classList.toggle("hidden",me!=="slip"),te&&te.classList.toggle("hidden",me!=="history"),ee&&ee.classList.toggle("active",me==="slip"),P&&P.classList.toggle("active",me==="history")}function Lt(t){$e!==t&&($e=t,J&&J.classList.toggle("active",t==="american"),U&&U.classList.toggle("active",t==="decimal"),Fe(),q())}function tt(t){if(t||(t=pe),!d)return;if(!t){d.textContent="";return}const s=new Date(`${t}T00:00:00`);Number.isNaN(s.getTime())?d.textContent=t:d.textContent=s.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"})}async function xt(){if(!(I!=null&&I.dates)||!I.dates.length){pe=B.currentDate,tt(pe);return}const t=[...I.dates].sort();for(const s of t){const o=await zt(s);if(!(o!=null&&o.simulated)){pe=s,tt(pe);return}}pe=t[t.length-1],tt(pe)}function pn(){if(!Se||!F||!Z)return;const t=Math.floor(Number(Se.value||0));if(!(t>0)){F.textContent="Enter a valid stake.";return}if(t>x.available){F.textContent="Stake exceeds available balance.";return}(!ue.length||de>=6||ue.length<52)&&(ue=Tt(),de=0),Ae(t),be(-t);const s=[ae(),ae()],o=[ae(),ae()],c={cards:s,bet:t,status:"playing",doubled:!1,split:!1};m={hands:[c],activeHand:0,dealer:o,stake:t,inRound:!0,settled:!1,message:"Hit, Stand, Double, or Split when available."};const u=G(c.cards),p=G(o);if(u.isBlackjack){m.inRound=!1,m.settled=!0,p.isBlackjack?(c.status="settled",c.result="push",m.message="Both you and the dealer have blackjack. Push.",be(t)):(c.status="blackjack",c.result="win",m.message="Blackjack! Paid 3:2.",be(t*2.5)),Pe(h,x,se,Q),de+=1,X();return}if(p.isBlackjack){m.inRound=!1,m.settled=!0,c.status="settled",c.result="lose",m.message="Dealer has blackjack.",de+=1,X();return}X()}function bn(){if(!m||!m.inRound)return;const t=_e();if(!t)return;t.cards.push(ae());const s=G(t.cards);s.total>21?(t.status="bust",t.result="lose",m.message=`Hand ${m.activeHand+1} busts with ${s.total}.`,qe()):s.total===21?(t.status="stood",m.message=`Hand ${m.activeHand+1} shows 21.`,qe()):m.message=`Hand ${m.activeHand+1} totals ${s.total}.`,X()}function gn(){if(!m||!m.inRound)return;const t=_e();if(!t)return;const s=G(t.cards);t.status="stood",m.message=`Hand ${m.activeHand+1} stands at ${s.total}.`,qe(),X()}function hn(){if(!m||!m.inRound)return;const t=_e();if(!t||!Nt(t))return;Ae(t.bet),be(-t.bet),t.bet*=2,t.doubled=!0,t.cards.push(ae());const s=G(t.cards);s.total>21?(t.status="bust",t.result="lose",m.message=`Hand ${m.activeHand+1} busts with ${s.total}.`):(t.status="stood",m.message=`Hand ${m.activeHand+1} doubles to ${s.total}.`),qe(),X()}function yn(){if(!m||!m.inRound)return;const t=_e();if(!t||!It(t))return;if(t.bet>x.available){m.message="Insufficient bankroll to split.",X();return}Ae(t.bet),be(-t.bet);const[s,o]=t.cards;t.cards=[s,ae()],t.status="playing",t.split=!0;const c={cards:[o,ae()],bet:t.bet,status:"playing",doubled:!1,split:!0};m.hands.splice(m.activeHand+1,0,c),m.message="Hands split. Play the first hand.",X()}function qe(){if(!m)return;const t=m,s=t.activeHand,o=t.hands.findIndex((u,p)=>p>s&&u.status==="playing");if(o!==-1){t.activeHand=o;return}const c=t.hands.findIndex(u=>u.status==="playing");if(c!==-1){t.activeHand=c;return}t.inRound=!1,kn()}function kn(){if(!m)return;const t=m;if(!t.hands.filter(c=>c.status!=="bust").length){_t();return}let o=G(t.dealer);for(;o.total<17||o.total===17&&o.isSoft;)t.dealer.push(ae()),o=G(t.dealer);_t()}function _t(){if(!m)return;const t=m,s=G(t.dealer),o=[];let c=0;t.hands.forEach((u,p)=>{const y=G(u.cards);if(u.status==="bust"){u.result="lose",u.status="settled",o.push(`Hand ${p+1} busts (${y.total}).`);return}const k=!u.split&&u.cards.length===2&&y.isBlackjack;if(s.total>21){u.result="win",u.status=k?"blackjack":"settled",k?o.push(`Hand ${p+1} blackjack! Dealer busts. Paid 3:2.`):o.push(`Hand ${p+1} wins ${y.total} vs dealer bust.`),c+=u.bet*(k?2.5:2);return}y.total>s.total?(u.result="win",u.status=k?"blackjack":"settled",k?o.push(`Hand ${p+1} blackjack beats dealer ${s.total}. Paid 3:2.`):o.push(`Hand ${p+1} wins ${y.total} to ${s.total}.`),c+=u.bet*(k?2.5:2)):y.total<s.total?(u.result="lose",u.status="settled",o.push(`Hand ${p+1} loses ${y.total} to ${s.total}.`)):(u.result="push",u.status="settled",o.push(`Hand ${p+1} pushes at ${y.total}.`),c+=u.bet)}),m.message=o.join("<br/>"),m.settled=!0,m.inRound=!1,m.activeHand=-1,de+=1,de>=6&&(ue=[],de=0),c!==0&&be(c),X()}function X(){if(!F||!Z||!O||!A||!oe||!re)return;const t=document.getElementById("blackjack-dealer-cards"),s=document.getElementById("blackjack-dealer-meta"),o=document.getElementById("blackjack-player-hands"),c=document.getElementById("blackjack-message");if(!m){F.textContent="Select a stake and deal.",Z.disabled=!1,O.disabled=!0,A.disabled=!0,oe.disabled=!0,re.disabled=!0,t&&(t.textContent="—"),s&&(s.textContent=""),o&&(o.innerHTML='<p class="muted">No active hands.</p>'),c&&(c.textContent="",c.classList.add("muted"));return}const u=_e(),p=!!(m.inRound&&u);Z.disabled=m.inRound,O.disabled=!p,A.disabled=!p,oe.disabled=!p||!u||!Nt(u),re.disabled=!p||!u||!It(u);const y=!m.inRound||m.settled,k=G(m.dealer);t&&(t.textContent=Dt(m.dealer,y)),s&&(s.textContent=y?`Total: ${k.total}${k.isSoft?" (soft)":""}`:"Total: ?",s.classList.toggle("muted",!y)),o&&(o.innerHTML="",m.hands.forEach((g,N)=>{const ye=document.createElement("div"),at=["blackjack-hand"];m.activeHand===N&&m.inRound&&at.push("active"),g.status==="bust"&&at.push("bust"),ye.className=at.join(" ");const ot=document.createElement("div");ot.className="blackjack-cards",ot.textContent=Dt(g.cards,!0),ye.appendChild(ot);const rt=document.createElement("div");rt.className="blackjack-hand-meta";const Ht=G(g.cards),Mn=[`Total: ${Ht.total}`,Ht.isSoft?"Soft":"",g.doubled?"Doubled":"",g.split?"Split":""].filter(Boolean);if(rt.textContent=Mn.join(" • "),ye.appendChild(rt),g.result||g.status==="blackjack"){const it=document.createElement("div"),Ot=g.status==="blackjack"?"blackjack":g.result??"win";it.className=`blackjack-hand-result ${Ot}`,it.textContent=g.status==="blackjack"?"BLACKJACK":Ot.toUpperCase(),ye.appendChild(it)}o.appendChild(ye)})),F.textContent=m.inRound?"Your move.":"Round complete.",c&&(m.message?(c.innerHTML=m.message,c.classList.remove("muted")):(c.textContent="",c.classList.add("muted")))}function vn(){if(!L||!f||!W||Le)return;const t=st();if(!(t>0)){f.textContent="Place bets on the table before spinning.",f.classList.remove("muted");return}if(t>x.available){f.textContent="Stake exceeds available balance.",f.classList.remove("muted");return}const s=Array.from(le.values()).map(g=>({...g}));Ae(t),Le=!0,f.textContent="Spinning...",f.classList.remove("muted"),M&&(M.disabled=!0),ie&&(ie.disabled=!0),ce.forEach(g=>g.classList.remove("active")),V&&(V.classList.remove("rolling"),V.offsetWidth,V.classList.add("rolling"));const o=Math.floor(Math.random()*Te.length),c=Te[o],u=o*ke+ke/2,p=(360-xe%360+360)%360,y=4+Math.floor(Math.random()*3),k=(p-u+360)%360;xe=xe+y*360+k,W.style.transform=`rotate(${xe}deg)`,window.setTimeout(()=>{V&&(V.classList.remove("rolling"),V.style.transform=`rotate(${u}deg) translateY(-82px)`),Nn(c);const g=Dn(s,c);f.textContent=g.message,f.classList.toggle("muted",g.delta===0),g.delta!==0?be(g.delta):(Oe(),Pe(h,x,se,Q)),le.clear(),Ie(),Ue(),S={},M&&(M.disabled=!1),ie&&(ie.disabled=!1),Le=!1},Hs)}function _e(){if(!m)return null;const t=m.activeHand;return t<0||t>=m.hands.length?null:m.hands[t]}function Nt(t){return!(!(m!=null&&m.inRound)||t.status!=="playing"||t.cards.length!==2||t.doubled||x.available<t.bet)}function It(t){if(!(m!=null&&m.inRound)||t.status!=="playing"||t.cards.length!==2||t.split||x.available<t.bet)return!1;const[s,o]=t.cards;return Pt(s)===Pt(o)}function Pt(t){return t?t.startsWith("10")?"10":t.charAt(0):""}function Tt(t=6){const s=[];for(let o=0;o<t;o+=1)s.push(...wn());for(let o=s.length-1;o>0;o-=1){const c=Math.floor(Math.random()*(o+1));[s[o],s[c]]=[s[c],s[o]]}return s}function wn(){const t=[];for(const s of Rs)for(const o of js)t.push(`${s}${o}`);return t}function ae(){return ue.length||(ue=Tt()),ue.pop()??"??"}function G(t){let s=0,o=0;for(const p of t){const y=p.startsWith("10")?"10":p.charAt(0);y==="A"?(o+=1,s+=11):["K","Q","J"].includes(y)||y==="10"?s+=10:s+=Number(y)}let c=o;for(;s>21&&c>0;)s-=10,c-=1;const u=t.length===2&&s===21;return{total:s,isSoft:o>c,bust:s>21,isBlackjack:u}}function Dt(t,s){return t.length?s?t.join(" "):`${t[0]} ??`:""}function ge(t,s,o,c){const u=s.slice().sort(Ke),p=`${c}:${u.join("-")}:${o}`,y=le.get(p);y?y.amount+=K:le.set(p,{id:p,label:t,numbers:u,amount:K,payout:o,kind:c}),Ie();const k=st();f&&(f.textContent=`${t} placed for ${_(K)}. Total staked: ${_(k)}.`,f.classList.add("muted")),S={}}function Sn(t){const s=zs[t];s&&he()&&ge(s.label,s.numbers,s.payout,"outside")}function En(){he()&&ge("Basket (0,1,2,3)",qs,8,"inside")}function Bn(t){switch(t){case"straight":return"Straight (1 number)";case"split":return"Split (2 numbers)";case"street":return"Street (3 numbers)";case"corner":return"Corner (4 numbers)";case"sixline":return"Six Line (6 numbers)";default:return"Inside bet"}}function he(){const t=st()+K;return t>x.available?(f&&(f.textContent=`Total staked would be ${_(t)}, exceeding available balance ${_(x.available)}.`,f.classList.remove("muted")),!1):!0}function Mt(t){return t==="0"}function Cn(t,s){const o=[t,s].sort(Ke).join("-");return Us.has(o)}function $n(t){return t==="0"?"Choose 1, 2, or 3 to finish your split.":"Select the adjacent number to complete your split."}function jt(t){if(!Le){if(!(K>0)){f&&(f.textContent="Enter a stake before placing bets.",f.classList.remove("muted"));return}switch(Ze){case"straight":{if(!he())return;ge(`Straight ${t}`,[t],35,"inside"),S={};break}case"split":{const s=Mt(t),o=s?null:ze(t);if(!s&&!o){f&&(f.textContent="Split bets must use numbers on the main grid.",f.classList.remove("muted")),S={};return}if(!S.firstValue){S={firstValue:t,firstPos:o??void 0},f&&(f.textContent=$n(t),f.classList.remove("muted"));return}const c=S.firstValue,u=S.firstPos??null,p=Mt(c),y=s,k=o;let g=null;if(!p&&!y&&u&&k&&xn(u,k)?g=[c,t].sort(Ke):Cn(c,t)&&(g=[c,t].sort(Ke)),!g){S={},f&&(f.textContent="Those numbers do not form a valid split.",f.classList.remove("muted"));return}if(!he())return;ge(`Split ${g.join("-")}`,g,17,"inside"),S={};break}case"street":{const s=ze(t);if(!s){f&&(f.textContent="Street bets apply to numbers 1-36 only.",f.classList.remove("muted"));return}if(!he())return;const o=nt(s.row);ge(`Street ${o.join("-")}`,o,11,"inside"),S={};break}case"corner":{const s=ze(t);if(!s){f&&(f.textContent="Corner bets apply to numbers 1-36 only.",f.classList.remove("muted"));return}if(!S.firstValue||!S.firstPos){S={firstValue:t,firstPos:s},f&&(f.textContent="Select the diagonal neighbor to complete your corner.",f.classList.remove("muted"));return}const o=_n(S.firstPos,s);if(!o){S={},f&&(f.textContent="Corner bets require diagonal neighbors.",f.classList.remove("muted"));return}if(!he())return;ge(`Corner ${o.join("-")}`,o,8,"inside"),S={};break}case"sixline":{const s=ze(t);if(!s){f&&(f.textContent="Six line bets apply to numbers 1-36 only.",f.classList.remove("muted"));return}const o=s.row;if(S.firstRow==null){S={firstRow:o},f&&(f.textContent="Select the row above or below to complete your six line.",f.classList.remove("muted"));return}const c=S.firstRow;if(Math.abs(c-o)!==1){S={},f&&(f.textContent="Six line rows must be adjacent.",f.classList.remove("muted"));return}if(!he())return;const u=[c,o].sort((y,k)=>y-k),p=[...nt(u[0]),...nt(u[1])];ge(`Six Line ${p.join("-")}`,p,5,"inside"),S={};break}}}}function Ln(){le.clear(),S={},Ue(),Ie(),f&&(f.textContent=`Bets cleared. Total staked: ${_(0)}. Enter a stake and tap the board.`,f.classList.add("muted"))}function Ue(){L&&(L.value=String(K))}function ze(t){if(t==="0")return null;const s=Number(t);if(!Number.isFinite(s)||s<1||s>36)return null;const o=Math.floor((s-1)/3),c=(s-1)%3;return{row:o,col:c}}function Ne(t,s){return String(t*3+s+1)}function nt(t){return[0,1,2].map(s=>Ne(t,s))}function xn(t,s){return t.row===s.row&&Math.abs(t.col-s.col)===1||t.col===s.col&&Math.abs(t.row-s.row)===1}function _n(t,s){if(Math.abs(t.row-s.row)!==1||Math.abs(t.col-s.col)!==1)return null;const o=Math.min(t.row,s.row),c=Math.min(t.col,s.col);return[Ne(o,c),Ne(o,c+1),Ne(o+1,c),Ne(o+1,c+1)]}function Ke(t,s){return Rt(t)-Rt(s)}function Rt(t){return t==="0"?0:Number(t)}function st(){let t=0;return le.forEach(s=>{t+=s.amount}),t}function Ie(){const t=new Map;le.forEach(s=>{if(s.kind==="inside")for(const o of s.numbers)t.set(o,(t.get(o)||0)+s.amount)}),ce.forEach((s,o)=>{const c=s.querySelector(".roulette-chip-stack");if(!c)return;const u=t.get(o)||0;u>0?(c.textContent=_(u),c.classList.add("active")):(c.textContent="",c.classList.remove("active"))})}function Nn(t){ce.forEach(o=>o.classList.remove("active"));const s=ce.get(t);s&&s.classList.add("active")}function In(){if(!je)return;je.innerHTML="",ce.clear();const t=document.createElement("div");t.className="roulette-zero",t.dataset.number="0",t.innerHTML="<span>0</span>";const s=document.createElement("div");s.className="roulette-chip-stack",t.appendChild(s),t.addEventListener("click",()=>jt("0"));const o=document.createElement("div");o.className="roulette-zero-column",o.appendChild(t),ce.set("0",t),je.appendChild(o);const c=document.createElement("div");c.className="roulette-grid";for(let u=11;u>=0;u-=1)for(let p=0;p<3;p+=1){const y=u*3+(3-p),k=document.createElement("div"),g=String(y);k.className=`roulette-cell ${Ge(g)}`,k.dataset.number=g,k.innerHTML=`<span>${g}</span>`;const N=document.createElement("div");N.className="roulette-chip-stack",k.appendChild(N),k.addEventListener("click",()=>jt(g)),c.appendChild(k),ce.set(g,k)}je.appendChild(c),Ie()}function Pn(){if(!W)return;let t=0;const s=[];for(const o of Te){const c=Ks(Ge(o)),u=t,p=u+ke;s.push(`${c} ${u.toFixed(4)}deg ${p.toFixed(4)}deg`),t=p}W.style.setProperty("--roulette-gradient",`conic-gradient(${s.join(", ")})`),Tn()}function Tn(){if(!W)return;let t=W.querySelector(".roulette-wheel-numbers");t&&t.remove(),t=document.createElement("div"),t.className="roulette-wheel-numbers",Te.forEach((s,o)=>{const c=o*ke+ke/2,u=document.createElement("span");u.className=`roulette-wheel-number roulette-wheel-number-${Ge(s)}`,u.textContent=String(s),u.style.transform=`rotate(${c}deg) translateY(-82px) rotate(${-c}deg)`,t.appendChild(u)}),W.appendChild(t)}function Dn(t,s){const o=t.reduce((k,g)=>k+g.amount,0),c=Ge(s);let u=0;const p=[];for(const k of t)if(u-=k.amount,k.numbers.includes(s)){const g=k.amount*k.payout;u+=k.amount+g,p.push(`${k.label} wins ${_(g)}.`)}let y=`Ball lands on ${s} ${c==="green"?"GREEN":c.toUpperCase()}.`;return p.length?y+=` ${p.join(" ")}`:o>0&&(y+=` You lose ${_(o)}.`),{delta:u,message:y}}}Gs();
